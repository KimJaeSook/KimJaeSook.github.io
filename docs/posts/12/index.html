<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kim Jae Sook">
<meta name="dcterms.date" content="2024-02-03">

<title>확률과 통계(2024) - 12. 카이제곱검정</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">확률과 통계(2024)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">소개</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../webr.html"> 
<span class="menu-text">Web-R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../link.html"> 
<span class="menu-text">Link</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">12. 카이제곱검정</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">교재 9장</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kim Jae Sook </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 3, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#엑셀-실습하기" id="toc-엑셀-실습하기" class="nav-link active" data-scroll-target="#엑셀-실습하기">[엑셀] 실습하기</a></li>
  <li><a href="#r기초-실습하기" id="toc-r기초-실습하기" class="nav-link" data-scroll-target="#r기초-실습하기">[R기초] 실습하기</a>
  <ul class="collapse">
  <li><a href="#적합도-검정" id="toc-적합도-검정" class="nav-link" data-scroll-target="#적합도-검정">적합도 검정</a>
  <ul class="collapse">
  <li><a href="#mass-라이브러리에-있는-cars93의-price라는-자료가-정규분포인지-위-3가지-방법으로-확인해보자." id="toc-mass-라이브러리에-있는-cars93의-price라는-자료가-정규분포인지-위-3가지-방법으로-확인해보자." class="nav-link" data-scroll-target="#mass-라이브러리에-있는-cars93의-price라는-자료가-정규분포인지-위-3가지-방법으로-확인해보자.">MASS 라이브러리에 있는 Cars93의 price라는 자료가 정규분포인지 위 3가지 방법으로 확인해보자.</a></li>
  <li><a href="#mass-라이브러리의-cars93의-price라는-자료가-다른-분포t-f-chisq를-따르는지-확인해보자." id="toc-mass-라이브러리의-cars93의-price라는-자료가-다른-분포t-f-chisq를-따르는지-확인해보자." class="nav-link" data-scroll-target="#mass-라이브러리의-cars93의-price라는-자료가-다른-분포t-f-chisq를-따르는지-확인해보자.">MASS 라이브러리의 Cars93의 price라는 자료가 다른 분포(t, F, chisq)를 따르는지 확인해보자.</a></li>
  </ul></li>
  <li><a href="#중심극한정리central-limit-theory" id="toc-중심극한정리central-limit-theory" class="nav-link" data-scroll-target="#중심극한정리central-limit-theory">중심극한정리(Central limit theory)</a></li>
  <li><a href="#카이제곱검정을-활용한-적합도-검정" id="toc-카이제곱검정을-활용한-적합도-검정" class="nav-link" data-scroll-target="#카이제곱검정을-활용한-적합도-검정">카이제곱검정을 활용한 적합도 검정</a>
  <ul class="collapse">
  <li><a href="#독감접종률-적합도-검정" id="toc-독감접종률-적합도-검정" class="nav-link" data-scroll-target="#독감접종률-적합도-검정">독감접종률 적합도 검정</a></li>
  <li><a href="#시장점유율-적합도-검정" id="toc-시장점유율-적합도-검정" class="nav-link" data-scroll-target="#시장점유율-적합도-검정">시장점유율 적합도 검정</a></li>
  <li><a href="#주사위--균등분포-적합도-검정" id="toc-주사위--균등분포-적합도-검정" class="nav-link" data-scroll-target="#주사위--균등분포-적합도-검정">주사위- 균등분포 적합도 검정</a></li>
  <li><a href="#as접수건수--포아송분포-적합도-검정" id="toc-as접수건수--포아송분포-적합도-검정" class="nav-link" data-scroll-target="#as접수건수--포아송분포-적합도-검정">AS접수건수- 포아송분포 적합도 검정</a></li>
  <li><a href="#머리둘레--정규분포-적합도-검정" id="toc-머리둘레--정규분포-적합도-검정" class="nav-link" data-scroll-target="#머리둘레--정규분포-적합도-검정">머리둘레- 정규분포 적합도 검정</a></li>
  </ul></li>
  <li><a href="#카이제곱검정을-활용한-동질성-검정" id="toc-카이제곱검정을-활용한-동질성-검정" class="nav-link" data-scroll-target="#카이제곱검정을-활용한-동질성-검정">카이제곱검정을 활용한 동질성 검정</a>
  <ul class="collapse">
  <li><a href="#세-지역의-독감-접종률이-다른지-검정하기" id="toc-세-지역의-독감-접종률이-다른지-검정하기" class="nav-link" data-scroll-target="#세-지역의-독감-접종률이-다른지-검정하기">세 지역의 독감 접종률이 다른지 검정하기</a></li>
  <li><a href="#cars93-데이터셋에서-에어백-비율-검정" id="toc-cars93-데이터셋에서-에어백-비율-검정" class="nav-link" data-scroll-target="#cars93-데이터셋에서-에어백-비율-검정">Cars93 데이터셋에서 에어백 비율 검정</a></li>
  <li><a href="#homogeneity-test-동질성-검정" id="toc-homogeneity-test-동질성-검정" class="nav-link" data-scroll-target="#homogeneity-test-동질성-검정">Homogeneity Test 동질성 검정</a></li>
  </ul></li>
  <li><a href="#카이제곱검정을-활용한-독립성-검정" id="toc-카이제곱검정을-활용한-독립성-검정" class="nav-link" data-scroll-target="#카이제곱검정을-활용한-독립성-검정">카이제곱검정을 활용한 독립성 검정</a>
  <ul class="collapse">
  <li><a href="#두-분류변수의-표-요약-교차표-분할표-이원분류표" id="toc-두-분류변수의-표-요약-교차표-분할표-이원분류표" class="nav-link" data-scroll-target="#두-분류변수의-표-요약-교차표-분할표-이원분류표">두 분류변수의 표 요약: 교차표, 분할표, 이원분류표</a></li>
  <li><a href="#fisher의-exact결정" id="toc-fisher의-exact결정" class="nav-link" data-scroll-target="#fisher의-exact결정">Fisher의 Exact결정</a></li>
  <li><a href="#성별과-흡연여부의-독립성-검정" id="toc-성별과-흡연여부의-독립성-검정" class="nav-link" data-scroll-target="#성별과-흡연여부의-독립성-검정">성별과 흡연여부의 독립성 검정</a></li>
  <li><a href="#전공과-학점-분할표" id="toc-전공과-학점-분할표" class="nav-link" data-scroll-target="#전공과-학점-분할표">전공과 학점 분할표</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>날씨가 맑고, 흐리고, 눈 오고, 비 오고 등으로 조사되고, 직업이 전문직, 사무직, 노무직 등으로 분류되는 등 숫자가 아닌 범주형 형태로 얻어지는 자료를 분석하는 기본적인 도구로 카이제곱통계를 이용한다. 표본으로 얻어진 범주의 분포들이 주어진 분포에 부합하는지 알아보려는 <strong>적합도 검정</strong>, 범주형 변수들끼리의 독립성 여부를 알아보려는 <strong>독립성 검정</strong>, 두 개 이상의 집단에서의 분포가 같은지 알아보려는 <strong>동질성 검정</strong>을 할 수 있다.</p>
<section id="엑셀-실습하기" class="level1">
<h1>[엑셀] 실습하기</h1>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1cZFIO3oEOdq1TJei9U0KtIqilWzviEtlvfXteJ5KFWs/edit?usp=sharing">카이제곱검정</a> <small>(sasa메일로 로그인해야 내용을 볼 수 있습니다.)</small></li>
</ul>
</section>
<section id="r기초-실습하기" class="level1">
<h1>[R기초] 실습하기</h1>
<section id="적합도-검정" class="level2">
<h2 class="anchored" data-anchor-id="적합도-검정">적합도 검정</h2>
<ul>
<li><p>특정 분포를 따르는지 알아보는 방법을 <strong>적합도 검정</strong>(Goodness of fit test)이라고 한다.</p></li>
<li><p><strong>정규분포 적합도 검정</strong>으로는 <strong>콜모그로프-스미르노프 검정</strong>, <strong>샤피로 윌크 검정</strong>, <strong>앤더슨 달링 검정</strong>이 주로 사용된다. 세 가지 방법은 결과가 거의 비슷하게 나온다.</p></li>
</ul>
<section id="mass-라이브러리에-있는-cars93의-price라는-자료가-정규분포인지-위-3가지-방법으로-확인해보자." class="level3">
<h3 class="anchored" data-anchor-id="mass-라이브러리에-있는-cars93의-price라는-자료가-정규분포인지-위-3가지-방법으로-확인해보자.">MASS 라이브러리에 있는 Cars93의 price라는 자료가 정규분포인지 위 3가지 방법으로 확인해보자.</h3>
<ul>
<li><span style="color: blue;"><strong>Kolmogorov-smirnov test</strong> (KS test)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>price <span class="ot">=</span> Cars93<span class="sc">$</span>Price</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha = 0.05 &gt; p ==&gt; H0 reject</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(price, <span class="st">"pnorm"</span>)  <span class="co"># 귀무가설은 '변수 X가 정규분포를 따른다'이고, 대립가설은 '정규분포를 따르지 않는다'이다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(price, "pnorm"): ties should not be present for the
Kolmogorov-Smirnov test</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  price
D = 1, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 검정 결과, p &lt; 2.2e-16 = 0.00000000000000022 이므로 귀무가설을 기각한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><span style="color: blue;"><strong>Shapiro-wilk test</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha = 0.05 &gt; p ==&gt; H0 reject</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(price)  <span class="co"># 귀무가설은 '변수 X가 정규분포를 따른다'이고, 대립가설은 '정규분포를 따르지 않는다'이다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  price
W = 0.88051, p-value = 4.235e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 검정 결과, p = 4.235e-07 = 0.0000004235 이므로 귀무가설을 기각한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><span style="color: blue;"><strong>Anderson darling test</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('nortest')  # nortest 라이브러리가 없으면 설치하기</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ad.test</span>(price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  price
A = 2.6704, p-value = 8.797e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha = 0.05 &gt; p ==&gt; H0 reject</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 검정 결과, p = 8.797e-07 = 0.0000008797 이므로 귀무가설을 기각한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mass-라이브러리의-cars93의-price라는-자료가-다른-분포t-f-chisq를-따르는지-확인해보자." class="level3">
<h3 class="anchored" data-anchor-id="mass-라이브러리의-cars93의-price라는-자료가-다른-분포t-f-chisq를-따르는지-확인해보자.">MASS 라이브러리의 Cars93의 price라는 자료가 다른 분포(t, F, chisq)를 따르는지 확인해보자.</h3>
<ul>
<li><span style="color: blue;"><strong>Kolmogorov-smirnov test</strong> (KS test)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(price, <span class="st">'pnorm'</span>)  <span class="co"># 정규분포를 따르는지 검정하기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(price, "pnorm"): ties should not be present for the
Kolmogorov-Smirnov test</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  price
D = 1, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(price, <span class="st">'pt'</span>, <span class="at">df=</span><span class="dv">30</span>)  <span class="co"># 자유도가 30인 t분포를 따르는지 검정하기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(price, "pt", df = 30): ties should not be present
for the Kolmogorov-Smirnov test</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  price
D = 1, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(price, <span class="st">'pf'</span>, <span class="at">df1=</span><span class="dv">30</span>, <span class="at">df2=</span><span class="dv">40</span>)  <span class="co"># 자유도가 30, 40인 F분포를 따르는지 검정하기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(price, "pf", df1 = 30, df2 = 40): ties should not be
present for the Kolmogorov-Smirnov test</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  price
D = 1, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(price, <span class="st">'pchisq'</span>, <span class="at">df=</span><span class="dv">30</span>)  <span class="co"># 자유도가 30인 카이제곱분포를 따르는지 검정하기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(price, "pchisq", df = 30): ties should not be
present for the Kolmogorov-Smirnov test</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  price
D = 0.60067, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
</div>
</section>
</section>
<section id="중심극한정리central-limit-theory" class="level2">
<h2 class="anchored" data-anchor-id="중심극한정리central-limit-theory">중심극한정리(Central limit theory)</h2>
<p>중심극한정리란 변수 <span class="math inline">\(X\)</span>가 정규분포를 따르지는 않지만, 만약 모집단으로부터 충분한 크기의 표본을 뽑았다면(25~30개 이상) 통계량의 분포인 표본분포가 정규분포에 근사한다는 이론이다. 따라서 표본을 충분히 크게 뽑는다면 모집단이 정규분포를 따르지 않아도 중심극한정리에 의해 표본분포가 정규분포를 따른다.</p>
</section>
<section id="카이제곱검정을-활용한-적합도-검정" class="level2">
<h2 class="anchored" data-anchor-id="카이제곱검정을-활용한-적합도-검정">카이제곱검정을 활용한 적합도 검정</h2>
<p>코로나 접종을 받은 사람의 비율이 20대, 30대, 40대 연령에서 동일한지 <span class="math inline">\(\dfrac{1}{3}\)</span>, <span class="math inline">\(\dfrac{1}{3}\)</span>, <span class="math inline">\(\dfrac{1}{3}\)</span>로 검정하거나, 중간시험에서 A, B, C학점을 받은 비율이 동일한지 <span class="math inline">\(\dfrac{1}{3}\)</span>, <span class="math inline">\(\dfrac{1}{3}\)</span>, <span class="math inline">\(\dfrac{1}{3}\)</span>로 검정, 또는 <span class="math inline">\(20\%\)</span>, <span class="math inline">\(50\%\)</span>, <span class="math inline">\(30\%\)</span>인지 검정하는 것을 <strong>단일 분류변수에 대한 검정</strong>이라고 한다. 범주형 변수의 분포에 대한 적합성 검정은 카이제곱 분포를 이용할 수 있다.</p>
<section id="독감접종률-적합도-검정" class="level3">
<h3 class="anchored" data-anchor-id="독감접종률-적합도-검정">독감접종률 적합도 검정</h3>
<ul>
<li><span style="color: blue;"><strong>독감을 접종한 사람들의 거주지역에 따라 독감 접종률의 차이가 있는지 검정해보자.</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## goodness-of-fit test for one sample</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># area1 area2 area3  </span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: p1 = p2 = p3 ==&gt; HO: p1=p2=p3=1/3</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># o1 = 19, o2=14, o3 = 13,  n=46</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>o1<span class="ot">=</span><span class="dv">19</span> ; o2<span class="ot">=</span><span class="dv">14</span> ; o3<span class="ot">=</span><span class="dv">13</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> o1 <span class="sc">+</span> o2 <span class="sc">+</span> o3</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(o1, o2, o3)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) ) <span class="co">#검정결과 귀무가설 채택, 세 지역의 접종률은 동일함</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  x
X-squared = 1.3478, df = 2, p-value = 0.5097</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span> )) <span class="co">#귀무가설을 1/4, 2/4, 1/4로 바꿀 수도 있음. 검정결과 귀무가설 기각됨</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  x
X-squared = 8.6087, df = 2, p-value = 0.01351</code></pre>
</div>
</div>
</section>
<section id="시장점유율-적합도-검정" class="level3">
<h3 class="anchored" data-anchor-id="시장점유율-적합도-검정">시장점유율 적합도 검정</h3>
<ul>
<li><span style="color: blue;"><strong>다음은 제품 4개에 대해 알려진 시장점유율과 실제 500명을 대상으로 사용하고 있는 제품의 사용자수를 나타낸 것이다.</strong></span> <img src="table1.png" class="center-image img-fluid"> <span style="color: blue;"><strong>알려진 시장점유율과 관측값이 차이가 나는지 검정하시오.</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.test(x=범주별 관측도수, p=범주별 비율, rescale.p, correct)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale.p: p의 합이 1이 아닐때, 1이 되도록 스케일을 조정할지 결정, F가 기본값</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># correct: 연속성 수정 여부, T가 기본값</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">110</span>, <span class="dv">195</span>,  <span class="dv">47</span>, <span class="dv">148</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(x, <span class="at">p=</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  x
X-squared = 1.3317, df = 3, p-value = 0.7216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 검정 통계량이 1.3317이고, p값이 0.7216이다.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p값이 0.05(5%) 이상이므로 귀무가설을 기각할 수 없고,</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 관측된 데이터는 기대되는 빈도와 통계적으로 유의미한 차이가 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="주사위--균등분포-적합도-검정" class="level3">
<h3 class="anchored" data-anchor-id="주사위--균등분포-적합도-검정">주사위- 균등분포 적합도 검정</h3>
<ul>
<li><span style="color: blue;"><strong>주사위의 각 면이 나올 확률이 같은지 알아보기 위해 1200번을 던졌더니 210, 180, 185, 220, 195, 210이 나왔다. 이에 대해 이 주사위의 각 면이 나올 확률이 동일한지 검정하시오.</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">210</span>, <span class="dv">180</span>, <span class="dv">185</span>, <span class="dv">220</span>, <span class="dv">195</span>, <span class="dv">210</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(x, <span class="at">p=</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  x
X-squared = 6.25, df = 5, p-value = 0.2826</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 검정 통계량이 6.25이고, p값이 0.2826이다.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p값이 0.05(5%) 이상이므로 귀무가설을 기각할 수 없고,</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 주사위의 각 면이 나올 확률이 다르지 않으며, 각 면이 200번으로 나오지 않은 것은 확률적인 우연 변동이다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="as접수건수--포아송분포-적합도-검정" class="level3">
<h3 class="anchored" data-anchor-id="as접수건수--포아송분포-적합도-검정">AS접수건수- 포아송분포 적합도 검정</h3>
<ul>
<li><span style="color: blue;"><strong>다음은 하루에 발생한 의료영상기기 AS접수건수이다. 이 자료로부터 하루에 발생하는 AS요청건수가 포아송분포를 따른다고 가정하는 것이 적합한지 적합도 검정을 하시오.</strong></span> <img src="table2.png" class="center-image img-fluid"></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">67</span>, <span class="dv">33</span>, <span class="dv">3</span>, <span class="dv">3</span>)  <span class="co"># 관측된 빈도</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)  <span class="co"># 총 건수</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> observed) <span class="sc">/</span> total  <span class="co"># 포아송 분포의 평균 발생빈도 계산(하루 평균)</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, lambda) <span class="sc">*</span> total  <span class="co"># 기대 빈도 계산</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>expected[<span class="dv">5</span>] <span class="ot">&lt;-</span> total <span class="sc">-</span> <span class="fu">sum</span>(expected[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])  <span class="co"># 마지막 카테고리는 4 이상의 모든 값 포함</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>chisq_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> observed, <span class="at">p =</span> expected <span class="sc">/</span> total)  <span class="co"># 카이제곱 적합도 검정 수행</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(x = observed, p = expected/total): Chi-squared
approximation may be incorrect</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_test)  <span class="co"># 검정 결과 출력</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  observed
X-squared = 4.9623, df = 4, p-value = 0.2912</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 범주의 기대빈도가 5보다 작은 경우에는 잘 맞지 않기에 경고메시지가 뜬다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span style="color: blue;"><strong>기대빈도가 낮은 주위의 범주들을 하나의 범주로 묶어서 붕괴된(collapsed) 빈도표를 만들어 카이제곱 적합도 검정을 수행한다.</strong></span> <img src="table3.png" class="center-image img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>Obs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">67</span>, <span class="dv">33</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>(n <span class="ot">&lt;-</span> <span class="fu">sum</span>(Obs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>(sample.mean <span class="ot">&lt;-</span> <span class="fu">drop</span>(x<span class="sc">%*%</span>Obs<span class="sc">/</span><span class="fu">sum</span>(Obs)))  <span class="co"># %*% := inner product, drop := as scalar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.77</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">dpois</span>(x, <span class="at">lambda=</span>sample.mean)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(prob, <span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(prob))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>Exp <span class="ot">&lt;-</span> n<span class="sc">*</span>prob</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="dv">5</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>Obs <span class="ot">&lt;-</span> <span class="fu">c</span>(Obs, <span class="dv">0</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(x, Obs, prob, Exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x Obs        prob        Exp
[1,] 0  94 0.463013068 92.6026137
[2,] 1  67 0.356520063 71.3040125
[3,] 2  33 0.137260224 27.4520448
[4,] 3   3 0.035230124  7.0460248
[5,] 4   3 0.006781799  1.3563598
[6,] 5   0 0.001194722  0.2389444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(Exp <span class="sc">&gt;=</span> <span class="dv">5</span>)  <span class="co"># 기대빈도가 5 이상인지 확인</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>Obs[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Obs[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>prob[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(prob[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>Exp[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Exp[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>Obs <span class="ot">&lt;-</span> Obs[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>Exp <span class="ot">&lt;-</span> Exp[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>chisq <span class="ot">&lt;-</span> (Obs<span class="sc">-</span>Exp)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>Exp</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(x, Obs, prob, Exp, chisq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x Obs       prob       Exp      chisq
[1,] 0  94 0.46301307 92.602614 0.02108675
[2,] 1  67 0.35652006 71.304013 0.25979637
[3,] 2  33 0.13726022 27.452045 1.12122091
[4,] 3   6 0.04320664  8.641329 0.80735485</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sum.chisq <span class="ot">&lt;-</span> <span class="fu">sum</span>(chisq)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>(p.value <span class="ot">&lt;-</span><span class="dv">1</span> <span class="sc">-</span><span class="fu">pchisq</span>(sum.chisq, <span class="at">df=</span><span class="dv">4-1-1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3313005</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 하루에 발생하는 AS요청건수의 분포가 포아송분포를 따른다는 귀무가설을 기각할 수 없다.</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="do">## vcd package --&gt; does not collapes!!!</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>Obs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">67</span>, <span class="dv">33</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>x.poi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">94</span>), <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">67</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">33</span>), <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">3</span>))</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>gf <span class="ot">&lt;-</span> <span class="fu">goodfit</span>(x.poi, <span class="at">type=</span> <span class="st">"poisson"</span>, <span class="at">method=</span><span class="st">"MinChisq"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.goodfit(gf): Chi-squared approximation may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Goodness-of-fit test for poisson distribution

             X^2 df  P(&gt; X^2)
Pearson 4.760495  3 0.1901988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf, <span class="at">main=</span><span class="st">"Count data vs Poisson distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="머리둘레--정규분포-적합도-검정" class="level3">
<h3 class="anchored" data-anchor-id="머리둘레--정규분포-적합도-검정">머리둘레- 정규분포 적합도 검정</h3>
<ul>
<li><span style="color: blue;"><strong>어느 모자 제작업체가 야구모자를 제작하여 야구팬들을 대상으로 판매하려는 계획을 세웠다. 어떤 크기의 모자를 얼마나 많이 만들어야 할지 결정하기 전에 야구팬들의 머리둘레길이가 어떤 분포를 이루고 있는지 알아야 하였다. 이를 조사하기 위해 야구장을 찾은 야구팬 중 임의로 50명을 선정하고 머리둘레를 재어 다음과 같은 크기 순으로 정렬된 자료를 얻었다.</strong></span></li>
</ul>
<p>51.92, 52.10, 52.25, 52.41, 52.48, 52.64, 53.02, 53.39, 53.40, 53.77, 54.00, 54.04, 54.30, 54.42, 54.77, 54.78, 54.85, 55.31, 55.33, 55.38, 55.49, 55.51, 55.68, 55.69, 55.80, 55.85, 56.03, 56.05, 56.10, 56.18, 56.22, 56.26, 56.29, 56.32, 56.35, 56.45, 56.57, 56.64, 56.71, 56.84, 56.91, 57.03, 57.14, 57.18, 58.00, 58.07, 58.32, 58.66, 59.26, 59.37</p>
<p><span style="color: blue;"><strong>이 자료로부터 야구팬들의 머리둘레길이가 정규분포를 따른다고 가정하는 것이 적절한지 적합도 검정을 하시오.</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">51.92</span>, <span class="fl">52.10</span>, <span class="fl">52.25</span>, <span class="fl">52.41</span>, <span class="fl">52.48</span>, <span class="fl">52.64</span>, <span class="fl">53.02</span>, <span class="fl">53.39</span>, <span class="fl">53.40</span>, <span class="fl">53.77</span>, <span class="fl">54.00</span>, <span class="fl">54.04</span>, <span class="fl">54.30</span>, <span class="fl">54.42</span>, <span class="fl">54.77</span>, <span class="fl">54.78</span>, <span class="fl">54.85</span>, <span class="fl">55.31</span>, <span class="fl">55.33</span>, <span class="fl">55.38</span>, <span class="fl">55.49</span>, <span class="fl">55.51</span>, <span class="fl">55.68</span>, <span class="fl">55.69</span>, <span class="fl">55.80</span>, <span class="fl">55.85</span>, <span class="fl">56.03</span>, <span class="fl">56.05</span>, <span class="fl">56.10</span>, <span class="fl">56.18</span>, <span class="fl">56.22</span>, <span class="fl">56.26</span>, <span class="fl">56.29</span>, <span class="fl">56.32</span>, <span class="fl">56.35</span>, <span class="fl">56.45</span>, <span class="fl">56.57</span>, <span class="fl">56.64</span>, <span class="fl">56.71</span>, <span class="fl">56.84</span>, <span class="fl">56.91</span>, <span class="fl">57.03</span>, <span class="fl">57.14</span>, <span class="fl">57.18</span>, <span class="fl">58.00</span>, <span class="fl">58.07</span>, <span class="fl">58.32</span>, <span class="fl">58.66</span>, <span class="fl">59.26</span>, <span class="fl">59.37</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>(x.mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55.5506</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(x.sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.859135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>(z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(p, x.mean, x.sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 53.16802 53.98591 54.57567 55.07959 55.55060 56.02161 56.52553 57.11529
 [9] 57.93318      Inf</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 53.16802 53.98591 54.57567 55.07959 55.55060 56.02161 56.52553 57.11529
 [9] 57.93318      Inf</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="dv">10</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  count[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(x[x<span class="sc">&lt;</span>z[i]])</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  7 10 14 17 22 26 36 42 44 50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  count[i] <span class="ot">&lt;-</span> count[i] <span class="sc">-</span> count[i<span class="dv">-1</span>]</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  7  3  4  3  5  4 10  6  2  6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>exp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>chisq_i <span class="ot">&lt;-</span> (count <span class="sc">-</span> exp)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(count, prob, exp, chisq_i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      count prob exp chisq_i
 [1,]     7  0.1   5     0.8
 [2,]     3  0.1   5     0.8
 [3,]     4  0.1   5     0.2
 [4,]     3  0.1   5     0.8
 [5,]     5  0.1   5     0.0
 [6,]     4  0.1   5     0.2
 [7,]    10  0.1   5     5.0
 [8,]     6  0.1   5     0.2
 [9,]     2  0.1   5     1.8
[10,]     6  0.1   5     0.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(chisq <span class="ot">&lt;-</span> <span class="fu">sum</span>(chisq_i))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(chisq, <span class="dv">7</span>)  <span class="co"># p-value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1885735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 야구팬들의 머리둘레길이가 정규분포를 따른다는 귀무가설을 기각할 수 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="카이제곱검정을-활용한-동질성-검정" class="level2">
<h2 class="anchored" data-anchor-id="카이제곱검정을-활용한-동질성-검정">카이제곱검정을 활용한 동질성 검정</h2>
<p>두 모집단에 대해서 단일변수의 분포가 동일한지 알아보는 것을 <strong>동질성 검정</strong>(homogeneity test)이라고 한다. 표본을 뽑을 때 모집단이 2개이기 때문에 서로 다른 모집단에서 각각 동일한 분류변수를 관측하는 것이 (적합도 검정과) 차이가 있다. 성인 남녀에서 공공기관 합격여부가 성공 또는 실패 비율이 남녀별 동일한지, 중간시험에서 남녀에 따라 학점의 분포가 동일한지, 도시농촌간 독감예방현황의 분포가 동일한지 등을 알아볼때 사용된다. 다음에 나오는 <strong>독립성 검정</strong>에서는 한 변수는 모집단을 나타내고, 다른 변수는 단일 분류변수를 나타낸다. 두 모집단이나 세 모집단 또는 여러 모집단에서 범주형 변수의 분포에 대한 동질성 검정도 chisq.test() 함수에 의해 검정할 수 있다.</p>
<section id="세-지역의-독감-접종률이-다른지-검정하기" class="level3">
<h3 class="anchored" data-anchor-id="세-지역의-독감-접종률이-다른지-검정하기">세 지역의 독감 접종률이 다른지 검정하기</h3>
<ul>
<li><span style="color: blue;"><strong>세 지역의 독감 접종 여부를 요약한 표가 다음과 같다. 세 지역의 독감 접종률이 다른지 검정하시오.</strong></span> <img src="table5.png" class="center4-image img-fluid"></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>area <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"area1"</span>, <span class="st">"area1"</span>, <span class="st">"area2"</span>, <span class="st">"area2"</span>, <span class="st">"area3"</span>, <span class="st">"area3"</span>) <span class="co">#각각에 대하여 접종 여부</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>flu_shot <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1.Yes"</span>, <span class="st">"2.No"</span>, <span class="st">"1.Yes"</span>, <span class="st">"2.No"</span>, <span class="st">"1.Yes"</span>, <span class="st">"2.No"</span>) <span class="co">#독감예방접종 여부</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>count <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">21</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">13</span>, <span class="dv">22</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(area, flu_shot, count)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">xtabs</span>(count <span class="sc">~</span> area <span class="sc">+</span> flu_shot, <span class="at">data=</span> data)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>tab  <span class="co">#교차표 만들기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       flu_shot
area    1.Yes 2.No
  area1    19   21
  area2    14   21
  area3    13   22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(tab)  <span class="co">#교차표 사용하기, 검정결과 귀무가설 채택, 지역에 따른 예방접종률의 분포는 동일함</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  tab
X-squared = 0.89274, df = 2, p-value = 0.6399</code></pre>
</div>
</div>
</section>
<section id="cars93-데이터셋에서-에어백-비율-검정" class="level3">
<h3 class="anchored" data-anchor-id="cars93-데이터셋에서-에어백-비율-검정">Cars93 데이터셋에서 에어백 비율 검정</h3>
<ul>
<li><span style="color: blue;"><strong>Cars93 데이터셋에서 에어백 여부의 비율에 대한 검정</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(Cars93<span class="sc">$</span>AirBags))  <span class="co"># HO: 1/3 1/3 1/3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Driver &amp; Passenger        Driver only               None 
         0.1720430          0.4623656          0.3655914 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x=</span><span class="fu">table</span>(Cars93<span class="sc">$</span>AirBags), <span class="at">p=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))  <span class="co">#검정결과 귀무가설 기각, 비율이 다름</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(Cars93$AirBags)
X-squared = 12.194, df = 2, p-value = 0.00225</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x=</span><span class="fu">table</span>(Cars93<span class="sc">$</span>AirBags), <span class="at">p=</span><span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.70</span>, <span class="fl">0.15</span>))  <span class="co">#귀무가설의 비율을 바꿔서 검정결과 귀무가설 기각, 즉 비율이 하나 이상 차이가 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(Cars93$AirBags)
X-squared = 36.621, df = 2, p-value = 1.116e-08</code></pre>
</div>
</div>
</section>
<section id="homogeneity-test-동질성-검정" class="level3">
<h3 class="anchored" data-anchor-id="homogeneity-test-동질성-검정">Homogeneity Test 동질성 검정</h3>
<ul>
<li><span style="color: blue;"><strong>남녀별 대학생의 전공자수를 조사하였다. 남학생은 45명 중 독문학, 불문학을 각각 30, 15명이 전공하고 있었고, 125명의 여학생은 각각 50, 75명이 전공하고 있었다. 남녀별 전공의 분포가 같은지 알아보고자 한다. 즉 남학생 집단에서의 전공에 대한 이항분포의 두 범주에 대한 확률과 여학생 집단에서의 전공비율이 각각 같은지 검정하시오.</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>homo <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">15</span>, <span class="dv">50</span>, <span class="dv">75</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(homo) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"남자"</span>,<span class="st">"여자"</span>), <span class="fu">c</span>(<span class="st">"독문학"</span>,<span class="st">"불문학"</span>))</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>n.marginal <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(homo)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>p.obs <span class="ot">&lt;-</span> homo <span class="sc">/</span> n.marginal</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>p.exp <span class="ot">&lt;-</span> <span class="fu">colSums</span>(homo)<span class="sc">/</span><span class="dv">350</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>homo.exp <span class="ot">&lt;-</span> n.marginal<span class="sc">%o%</span>p.exp</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>homo.exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       독문학   불문학
남자 10.28571 11.57143
여자 28.57143 32.14286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>homo.chisq <span class="ot">&lt;-</span> (homo <span class="sc">-</span> homo.exp)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> homo.exp</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>homo.chisq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       독문학    불문학
남자 37.78571  1.015873
여자 16.07143 57.142857</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(homo.chisq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    남자     여자 
38.80159 73.21429 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(xx <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(homo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  homo
X-squared = 8.4044, df = 1, p-value = 0.003743</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>xx<span class="sc">$</span>expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       독문학   불문학
남자 21.17647 23.82353
여자 58.82353 66.17647</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>xx<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>  <span class="co"># 독립이라는 가정 하에 기댓값</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       독문학   불문학
남자 3.676471 3.267974
여자 1.323529 1.176471</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(xx<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># 독립이라는 가정 하에 카이제곱값</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.444444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p값이 유의 수준(0.05)보다 낮으므로, 두 집단의 분포가 같다는 가정을 기각한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><span style="color: blue;"><strong>R에서 이러한 검정을 수행하기 위해 prop.test 함수를 사용할 수 있고, 이 함수는 두 또는 그 이상의 비율을 비교하는 데 사용된다.</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 남학생과 여학생의 독문학과 불문학 전공자 수</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>male_students <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">15</span>)   <span class="co"># 남학생 독문학 30명, 불문학 15명</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>female_students <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>) <span class="co"># 여학생 독문학 50명, 불문학 75명</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prop.test를 사용하여 두 집단 간의 비율 차이 검정</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">sum</span>(male_students), <span class="fu">sum</span>(female_students)), </span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="fu">c</span>(<span class="fu">sum</span>(male_students) <span class="sc">+</span> <span class="fu">sum</span>(female_students), <span class="fu">sum</span>(female_students) <span class="sc">+</span> <span class="fu">sum</span>(male_students)), </span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  c(sum(male_students), sum(female_students)) out of c(sum(male_students) + sum(female_students), sum(female_students) + sum(male_students))
X-squared = 73.424, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.5702594 -0.3709171
sample estimates:
   prop 1    prop 2 
0.2647059 0.7352941 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p값이 유의 수준(0.05)보다 낮으므로, 두 집단의 분포가 같다는 가정을 기각한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="카이제곱검정을-활용한-독립성-검정" class="level2">
<h2 class="anchored" data-anchor-id="카이제곱검정을-활용한-독립성-검정">카이제곱검정을 활용한 독립성 검정</h2>
<p>분류변수에 대한 검정 중 가장 빈번하게 사용되며, 한 모집단에서 두 개의 분류변수가 서로 독립적으로 움직이는지 확인하기 위해 사용하는 분석법이다. 즉 혈액형과 성별, 학년과 학점 등 두 개의 범주형 변수에 대해서 먼저 두 변수 간의 관련성이 주된 관심이 되며, 두 변수가 독립인지 검정하게 되는데, 이를 <strong>독립성 검정</strong>이라고 한다.</p>
<section id="두-분류변수의-표-요약-교차표-분할표-이원분류표" class="level3">
<h3 class="anchored" data-anchor-id="두-분류변수의-표-요약-교차표-분할표-이원분류표">두 분류변수의 표 요약: 교차표, 분할표, 이원분류표</h3>
<ul>
<li><p>2개의 분류변수 혹은 번주변수가 주어진 경우, 관련성을 알아보기 위해 표로 요약하여 두 범주형 변수가 서로 독립인지 아닌지 파악하게 된다. 각 범주변수의 범주값을 가로와 세로에 나열해 교차되는 곳의 관측 도수를 세어서 요약한 표를 <strong>교차표</strong>, <strong>분할표</strong>, <strong>이원분류표</strong>라 한다. 이렇게 표로 먼저 요약한 후에 카이제곱 검정을 실시한다.</p></li>
<li><p>table(), xtabs() 함수를 이용한다.</p>
<ul>
<li>table(x1, x2): x1은 행변수, x2는 열변수</li>
<li>table(x1, x2, x3): x1은 행변수, x2는 열변수, x3는 층변수</li>
<li>xtabs(~x1+x2+x3, data=dataframe): ‘~’과 함께 각 분류변수를’+’로 연결</li>
</ul></li>
<li><p>동질성 검정은 한 모집단에서 두 분류변수 관계를 관측하는 것이고, 독립성 검정은 여러 모집단에서 한 분류변수를 측정하는 것이다. 교차표로 요악하는 방식은 동일하지만, 동질성 검정에서는 반드시 한 분류변수가 모집단을 나타낸다.</p></li>
<li><p>귀무가설(<span class="math inline">\(H_0\)</span>): <span class="math inline">\(p_{ij} = p_{i}\ p_{j}\)</span></p></li>
</ul>
<p><img src="table6.png" class="center3-image img-fluid"></p>
</section>
<section id="fisher의-exact결정" class="level3">
<h3 class="anchored" data-anchor-id="fisher의-exact결정">Fisher의 Exact결정</h3>
<ul>
<li>독립성 검정에서의 카이제곱 통계량 이용 조건
<ul>
<li>관측도수(셀)의 기대도수가 1 이상</li>
<li>기대도수가 5 이하인 셀이 20% 이하</li>
</ul></li>
<li>기대도수가 5 이하인 셀이 20%를 넘었을 때, Fisher의 Exact 검정 이용
<ul>
<li>기대도수가 5 이하인 셀이 20%를 넘었을 때, 다음 메시지 발생</li>
<li>“Warning in chisq.test(tcy): Chi-squared approximation may be incorrect”</li>
</ul></li>
<li>fisher.test() 함수 이용</li>
</ul>
</section>
<section id="성별과-흡연여부의-독립성-검정" class="level3">
<h3 class="anchored" data-anchor-id="성별과-흡연여부의-독립성-검정">성별과 흡연여부의 독립성 검정</h3>
<ul>
<li><span style="color: blue;"><strong>성별과 흡연여부는 서로 독립인지, 관련이 있는지 독립성을 검정하시오.</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>Sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] Female Male   Male   Male   Male   Female Male   Female Male   Male  
 [11] Female Male   Female Female Male   Female Female Male   Male   Male  
 [21] Male   Male   Male   Male   Female Male   Male   Male   Male   Male  
 [31] Female Male   Female Male   Male   Male   Female Male   Male   Male  
 [41] Female Female Male   Female Female Male   Male   Male   Female Female
 [51] Male   Male   Male   Male   Male   Male   Female Male   Male   Male  
 [61] Male   Female Female Female Female Male   Female Female Male   Male  
 [71] Female Male   Female Female Female Female Female Female Female Male  
 [81] Male   Male   Female Female Male   Female Female Female Male   Female
 [91] Male   Female Female Female Male   Female Male   Female Male   Female
[101] Male   Male   Female Female Female Female Female Female Male   Male  
[111] Female Male   Female Male   Female Female Female Male   Female Male  
[121] Male   Male   Female Male   Male   Male   Female Male   Female Female
[131] Male   Male   Female Female Male   Male   &lt;NA&gt;   Male   Male   Female
[141] Female Female Female Male   Female Male   Male   Male   Female Female
[151] Male   Female Female Male   Male   Male   Male   Female Male   Male  
[161] Female Male   Male   Female Male   Female Female Female Male   Male  
[171] Female Male   Female Female Female Female Male   Female Female Female
[181] Male   Female Female Male   Male   Male   Female Male   Male   Male  
[191] Male   Male   Male   Female Female Female Female Male   Female Female
[201] Female Male   Female Female Male   Female Female Male   Male   Female
[211] Female Female Male   Male   Female Male   Female Male   Female Male  
[221] Male   Female Female Female Female Female Female Male   Female Male  
[231] Female Male   Female Female Female Male   Female
Levels: Female Male</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>Smoke</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] Never Regul Occas Never Never Never Never Never Never Never Never Never
 [13] Never Never Never Never Never Never Never Never Never Never Never Never
 [25] Never Never Never Never Never Never Occas Never Heavy Never Regul Occas
 [37] Never Never Never Occas Never Never Never Never Never Never Regul Never
 [49] Occas Never Never Never Never Never Regul Never Never Never Never Occas
 [61] Never Never Never Never Never Never Never Never Never &lt;NA&gt;  Never Heavy
 [73] Never Never Never Heavy Never Heavy Never Never Never Never Never Never
 [85] Never Never Never Never Never Never Never Never Never Never Heavy Never
 [97] Regul Never Never Never Never Never Never Never Heavy Never Occas Never
[109] Never Regul Never Never Never Never Never Never Never Heavy Never Heavy
[121] Occas Occas Never Never Never Never Never Regul Never Never Never Never
[133] Never Occas Never Regul Never Never Never Never Never Never Never Never
[145] Never Never Regul Never Never Never Never Never Regul Never Never Never
[157] Heavy Never Never Regul Never Never Never Occas Never Never Never Regul
[169] Never Never Never Occas Regul Never Never Never Regul Never Regul Never
[181] Occas Occas Never Never Never Never Never Never Never Never Never Never
[193] Occas Never Never Never Never Never Occas Never Occas Never Never Never
[205] Regul Occas Never Never Never Never Never Never Never Never Never Never
[217] Never Never Never Never Heavy Never Never Never Never Never Heavy Never
[229] Regul Occas Never Never Never Never Never Never Never
Levels: Heavy Never Occas Regul</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1) cross table(교차표)</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="do">####(1) table()</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>tle_data <span class="ot">=</span> <span class="fu">table</span>(survey<span class="sc">$</span>Sex, survey<span class="sc">$</span>Smoke)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>tle_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
         Heavy Never Occas Regul
  Female     5    99     9     5
  Male       6    89    10    12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">marginSums</span>(tle_data, <span class="at">margin =</span> <span class="dv">1</span>)  <span class="co"># row sum</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Female   Male 
   118    117 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">marginSums</span>(tle_data, <span class="at">margin =</span> <span class="dv">2</span>)  <span class="co"># column sum</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Heavy Never Occas Regul 
   11   188    19    17 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tle_data)  <span class="co"># 표에 행과 열의 합계 추가</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
         Heavy Never Occas Regul Sum
  Female     5    99     9     5 118
  Male       6    89    10    12 117
  Sum       11   188    19    17 235</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="do">####(2) xtabs()</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>tbl_data <span class="ot">=</span> <span class="fu">xtabs</span>(<span class="sc">~</span>Sex<span class="sc">+</span>Smoke, <span class="at">data=</span>survey)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>tbl_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Smoke
Sex      Heavy Never Occas Regul
  Female     5    99     9     5
  Male       6    89    10    12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tbl_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Smoke
Sex      Heavy Never Occas Regul Sum
  Female     5    99     9     5 118
  Male       6    89    10    12 117
  Sum       11   188    19    17 235</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2) independence test, alpha=0.05</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="do">####(1) raw data</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(survey<span class="sc">$</span>Sex, survey<span class="sc">$</span>Smoke)  <span class="co"># 원데이터를 그대로 이용하기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  survey$Sex and survey$Smoke
X-squared = 3.5536, df = 3, p-value = 0.3139</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">####(2) crosstable</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(tbl_data)  <span class="co"># 교차표를 만들어서 검정하기, 귀무가설 채택(성별과 흡연여부는 독립임)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  tbl_data
X-squared = 3.5536, df = 3, p-value = 0.3139</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="do">####(3) CrossTable() of gmodels package</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages('gmodels')  # gmodels 패키지가 없으면 주석 지우고 실행하기</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gmodels' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>(survey<span class="sc">$</span>Sex, survey<span class="sc">$</span>Smoke, <span class="at">chisq =</span> T)  <span class="co"># 교차표와 카이제곱검정을 한꺼번에 실행함</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  235 

 
             | survey$Smoke 
  survey$Sex |     Heavy |     Never |     Occas |     Regul | Row Total | 
-------------|-----------|-----------|-----------|-----------|-----------|
      Female |         5 |        99 |         9 |         5 |       118 | 
             |     0.050 |     0.224 |     0.031 |     1.465 |           | 
             |     0.042 |     0.839 |     0.076 |     0.042 |     0.502 | 
             |     0.455 |     0.527 |     0.474 |     0.294 |           | 
             |     0.021 |     0.421 |     0.038 |     0.021 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|
        Male |         6 |        89 |        10 |        12 |       117 | 
             |     0.050 |     0.226 |     0.031 |     1.477 |           | 
             |     0.051 |     0.761 |     0.085 |     0.103 |     0.498 | 
             |     0.545 |     0.473 |     0.526 |     0.706 |           | 
             |     0.026 |     0.379 |     0.043 |     0.051 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|
Column Total |        11 |       188 |        19 |        17 |       235 | 
             |     0.047 |     0.800 |     0.081 |     0.072 |           | 
-------------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  3.553618     d.f. =  3     p =  0.3138744 


 </code></pre>
</div>
</div>
<ul>
<li><span style="color: blue;"><strong>성별과 대장암 유무에 대해 조사한 결과표가 다음과 같다. 성별과 대장암 유무가 관련이 있는지 독립성을 검정하시오.</strong></span> <img src="table7.png" class="center4-image img-fluid"></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">## less 5 frequency over 20% in crosstable(5이하의 도수가 20% 이상시 독립성 검정)</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="do">## fisher's exact test</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"male"</span>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>cancer <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1.Yes"</span>, <span class="st">"2.No"</span>, <span class="st">"1.Yes"</span>, <span class="st">"2.No"</span>)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>count <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">23</span>,<span class="dv">4</span>,<span class="dv">21</span>)</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(sex,cancer, count)</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">=</span> <span class="fu">xtabs</span>(count<span class="sc">~</span>sex<span class="sc">+</span>cancer, <span class="at">data=</span>data)</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        cancer
sex      1.Yes 2.No
  female     2   23
  male       4   21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(tab)  <span class="co"># 분석결과는 나오지만 오류메시지가 뜸</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(tab): Chi-squared approximation may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  tab
X-squared = 0.18939, df = 1, p-value = 0.6634</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">## fisher's exact test</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(tab)  <span class="co"># 검정결과, 성별과 대장암 발병여부는 독립임.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  tab
p-value = 0.6671
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.03819639 3.62439874
sample estimates:
odds ratio 
 0.4635832 </code></pre>
</div>
</div>
</section>
<section id="전공과-학점-분할표" class="level3">
<h3 class="anchored" data-anchor-id="전공과-학점-분할표">전공과 학점 분할표</h3>
<ul>
<li><span style="color: blue;"><strong>130명의 대학원생을 대상으로 학부학점과 대학원전공을 조사한 결과가 다음 표와 같다. 대학원전공과 학부학점 간의 관련이 있는지 검정하시오.</strong></span> <img src="table4.png" class="center-image img-fluid"></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">13</span>, <span class="dv">16</span>,</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>               <span class="dv">8</span>, <span class="dv">16</span>,  <span class="dv">7</span>,</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>              <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">17</span>), <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">byrow=</span>T)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(y) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"3.5-4.5"</span>,<span class="st">"2.5-3.5"</span>,<span class="st">"1.5-2.5"</span>), <span class="fu">c</span>(<span class="st">"사회과학"</span>,<span class="st">"자연과학"</span>,<span class="st">"공학"</span>))</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        사회과학 자연과학 공학
3.5-4.5       30       13   16
2.5-3.5        8       16    7
1.5-2.5       12       11   17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(y, <span class="at">correct=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  y
X-squared = 13.088, df = 4, p-value = 0.01085</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 학부성적과 대학원전공이 독립이라는 가정을 기각한다.</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(y, <span class="at">correct=</span>F)  <span class="co"># 독립된 가정에서의 기댓값 출력</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        사회과학  자연과학      공학
3.5-4.5 22.69231 18.153846 18.153846
2.5-3.5 11.92308  9.538462  9.538462
1.5-2.5 15.38462 12.307692 12.307692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>  <span class="co"># 독립된 가정에서의 카이제곱값</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         사회과학  자연과학      공학
3.5-4.5 2.3533246 1.4631682 0.2555411
2.5-3.5 1.2908189 4.3771712 0.6755583
1.5-2.5 0.7446154 0.1389423 1.7889423</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
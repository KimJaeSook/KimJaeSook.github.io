---
title: "10. 하나의 모집단에 대한 가설검정(평균)"
author: "Kim Jae Sook"
date: "2024-02-01"
categories: [Statistics, 교재 8장]
image: "image.png"
---

# \[엑셀\] 실습하기

-   [하나의 모집단에 대한 가설검정(평균)](https://docs.google.com/spreadsheets/d/11c2vcLd-oHIOs_xLF-8BTxlgd5Lp9Qk9Uo94zmuhw7U/edit?usp=sharing) <small>(sasa메일로 로그인해야 내용을 볼 수 있습니다.)</small>

# \[R기초\] 실습하기

## 모평균 $\mu$에 대한 검정

### $\sigma$를 아는 경우

-   어떤 이들은 한국 청소년들의 하루 평균 TV 시청 시간이 3시간이라 주장하고, 다른 이들은 공부하느라 시청 시간이 3시간이 안될 것이라 주장하고 있다. 어느 편이 맞는지 알아보기 위하여 단순임의 추출한 100명을 조사한 결과 평균이 2.75시간이었다. TV 시청 시간은 정규분포를 하며 분산은 과거 조사에서 1로 알려져 있다.

```{r}
# 가설검정을 위한 변수 설정(양측검정)
mu0 <- 3 # 귀무 가설의 평균
xbar <- 2.75 # 표본의 평균
sigma <- 1 # 모집단의 분산 (표준편차)
n <- 100 # 표본의 크기

z <- (xbar - mu0) / (sigma / sqrt(n))  # z-검정 수행
p_value <- 2 * pnorm(-abs(z))  # p-값 계산
z
p_value  # 결과 출력

# p값이 σ=0.05보다 작으므로 귀무가설을 기각하게 되어 
# 청소년들의 하루 평균 TV 시청 시간이 3시간이라고 할 수 없다.
```

### $\sigma$를 모르는 경우

-   건강한 성인의 콜레스테롤 수치는 220 이하라고 한다. 콜레스테롤이 높은 사람은 심장마비가 발생할 가능성이 더 높은 것으로 알려져 있다. 이를 확인하기 위해 30명의 심장마비 환자를 조사하여 평균 콜레스테롤이 231이며, 표준편차가 20인 것을 알아냈다. 심장마비 환자들의 평균 콜레스테롤은 정상인의 평균 콜레스테롤보다 높은 수치라고 결론내릴 수 있는가?

```{r}
t_test <- function(alpha, mu0, xbar, s, n){
    se = s/sqrt(n)
    t = (xbar-mu0)/se
    cr = qt(1-alpha, df=n-1)
    p_value = pt(t, df= n-1, lower.tail=F)
    if(p_value < alpha) result = "Reject H0" else result = "Accept H0"
    
    print(paste("Hypothesis testing for H0: mu = ",mu0,"or Ha: mu > ",mu0))
    print(c(paste("t Statistics is ", round(t,4), 
          "and Critical Region is ", round(cr, 4)), paste("p-value =", round(p_value,4))))
    print(paste(result, "at significance level", alpha))
}

t_test(0.05, 220, 231, 20, 30)  

# p값이 σ=0.05보다 작으므로 귀무가설을 기각하게 되어 
# 심장마비 환자들의 평균 콜레스테롤은 정상의 평균 콜레스테롤보다 높다고 결론을 내린다.
```

### MASS 라이브러리에 있는 Cars93의 연료탱크용량의 모평균 추정하기(t검정)

```{r}
library(MASS)
fuel = Cars93$Fuel.tank.capacity

## mu of fuel is 16.
# H0: mu = 16
# H1: mu is not 16 (양측검정)

## normality test
hist(fuel)  # 좌우대칭인지 대략적으로 살펴보기
shapiro.test(fuel)  # alpha=0.05 > p ==> H0 reject인데, p=0.287이므로 정규분포를 따름

## 1. hypothesis H0 : mu=16  H1 : mu is not 16
## 2. alpha = 0/05
## 3. test statistic = barX ~ N()
## 4. p
## 5. alpha > p ==> H0 reject

t.test(fuel, mu=16, alternative = 'two.sided')  # p=0.5372 > 0.5이므로 H0를 기각할 수 없고, 즉 연료탱크 용량의 평균은 16이라 할 수 있음

t.test(fuel, mu=16, alternative = 'greater')  # p=0.02686 < 0.5이므로 H0를 기각하고, 즉 연료탱크 용량의 평균은 16보다 큼(단측검정이 양측검정보다 귀무가설을 기각하기 쉬움)

t.test(fuel, mu=16, alternative = 'less')  # p=0.9731 > 0.5이므로 H0를 채택한다. 즉 연료탱크 용량의 평균은 16보다 작지 않음

```

### MASS 라이브러리에 있는 Cars93의 가격의 모평균 추정하기(비모수적 방법)

```{r}
library(MASS)
price = Cars93$Price

## mu of fuel is 16.
# H0: mu = 16
# H1: mu is not 16 (양측검정)

## normality test
hist(price)  # 좌우대칭인지 대략적으로 살펴보기
shapiro.test(price)  # alpha > p ==> H0 reject인데, p=0.0000004235이므로 정규분포를 따른다고 할 수 없음

## Cars93$Price, nor normal dist~, n>30이면 중심극한정리에 의해 표본평균의 정규성을 활용하여 검정

## n<30(소표본) ==> non-parametric test of one sample(비모수적 방법)
# 1. hypothesis H0 : mu=19  H1 : mu is not 19
# 2. alpha = 0/05

wilcox.test(price, mu=19, alternative = 'two.sided') # 윌콕슨의 부호순위검정, alpha=0.05 > p ==> H0 reject인데, p=0.4701이므로 price의 평균은 19라 할 수 있음

wilcox.test(price, mu=19, alternative = 'greater') # p=0.7662이므로 price의 평균은 19보다 크지 않음

wilcox.test(price, mu=19, alternative = 'less') # p=0.235이므로 price의 평균은 19보다 작지 않음
```

## 모비율 $p$에 대한 검정

-   경기도 어떤 지역에 새로운 지역 신문을 발행하기 위해서는 구독률이 12%를 넘어야 광고주를 안정적으로 확보할 수 있다고 한다. 새로운 지역 신문의 발행을 고심하는 한 신문사에서는 400명의 주민을 대상으로 만약 신문이 발행되면 구독을 할 것인지를 물어서 58명이 구독할 것이라는 답을 얻었다. 새로운 지역 신문의 구독률이 12%를 초과할 것이라고 결론내릴 수 있는가?(유의수준 5% 사용)

```{r}
prop_test <- function(alpha, p, N, n){
    phat = n/N
    se = sqrt((p*(1-p))/N)
    z = (phat - p) / se
    cr = qnorm(1-alpha)
    p_value = pnorm(z, lower.tail=F)
    if(p_value < alpha) result = "Reject H0" else result = "Accept H0"
    
    print(paste("Hypothesis testing for H0: mu = ",p,"or Ha: mu > ",p))
    print(c(paste("p_hat is ", round(phat,5), "/ Z Statistics is ", round(z,4),
           "and Critical Region is ", round(cr, 4)), paste("p-value =", round(p_value,4))))
    print(paste(result, "at significance level", alpha))
}

prop_test(0.05, 0.12, 400,58)

# p값이 유의수준 σ=0.05를 초과하므로 귀무가설을 기각하지 못한다.
# 새로운 지역 신문은 구독률이 12%를 초과할 것이라 결론내릴 수 없다.
```

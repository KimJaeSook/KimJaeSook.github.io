<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kim Jae Sook">
<meta name="dcterms.date" content="2024-02-01">

<title>확률과 통계(2024) - 10. 하나의 모집단에 대한 가설검정(평균)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">확률과 통계(2024)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">소개</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../webr.html"> 
<span class="menu-text">Web-R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../link.html"> 
<span class="menu-text">Link</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">10. 하나의 모집단에 대한 가설검정(평균)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">교재 8장</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kim Jae Sook </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 1, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#엑셀-실습하기" id="toc-엑셀-실습하기" class="nav-link active" data-scroll-target="#엑셀-실습하기">[엑셀] 실습하기</a></li>
  <li><a href="#r기초-실습하기" id="toc-r기초-실습하기" class="nav-link" data-scroll-target="#r기초-실습하기">[R기초] 실습하기</a>
  <ul class="collapse">
  <li><a href="#모평균-mu에-대한-검정" id="toc-모평균-mu에-대한-검정" class="nav-link" data-scroll-target="#모평균-mu에-대한-검정">모평균 <span class="math inline">\(\mu\)</span>에 대한 검정</a>
  <ul class="collapse">
  <li><a href="#sigma를-아는-경우" id="toc-sigma를-아는-경우" class="nav-link" data-scroll-target="#sigma를-아는-경우"><span class="math inline">\(\sigma\)</span>를 아는 경우</a></li>
  <li><a href="#sigma를-모르는-경우" id="toc-sigma를-모르는-경우" class="nav-link" data-scroll-target="#sigma를-모르는-경우"><span class="math inline">\(\sigma\)</span>를 모르는 경우</a></li>
  <li><a href="#mass-라이브러리에-있는-cars93의-연료탱크용량의-모평균-추정하기t검정" id="toc-mass-라이브러리에-있는-cars93의-연료탱크용량의-모평균-추정하기t검정" class="nav-link" data-scroll-target="#mass-라이브러리에-있는-cars93의-연료탱크용량의-모평균-추정하기t검정">MASS 라이브러리에 있는 Cars93의 연료탱크용량의 모평균 추정하기(t검정)</a></li>
  <li><a href="#mass-라이브러리에-있는-cars93의-가격의-모평균-추정하기비모수적-방법" id="toc-mass-라이브러리에-있는-cars93의-가격의-모평균-추정하기비모수적-방법" class="nav-link" data-scroll-target="#mass-라이브러리에-있는-cars93의-가격의-모평균-추정하기비모수적-방법">MASS 라이브러리에 있는 Cars93의 가격의 모평균 추정하기(비모수적 방법)</a></li>
  </ul></li>
  <li><a href="#모비율-p에-대한-검정" id="toc-모비율-p에-대한-검정" class="nav-link" data-scroll-target="#모비율-p에-대한-검정">모비율 <span class="math inline">\(p\)</span>에 대한 검정</a></li>
  <li><a href="#두-독립-표본-위치-차이-검정" id="toc-두-독립-표본-위치-차이-검정" class="nav-link" data-scroll-target="#두-독립-표본-위치-차이-검정">두 독립 표본 위치 차이 검정</a>
  <ul class="collapse">
  <li><a href="#두-독립-표본-위치-차이-검정이란" id="toc-두-독립-표본-위치-차이-검정이란" class="nav-link" data-scroll-target="#두-독립-표본-위치-차이-검정이란">두 독립 표본 위치 차이 검정이란</a></li>
  <li><a href="#두-독립-모집단의-평균을-비교할-때의-조건" id="toc-두-독립-모집단의-평균을-비교할-때의-조건" class="nav-link" data-scroll-target="#두-독립-모집단의-평균을-비교할-때의-조건">두 독립 모집단의 평균을 비교할 때의 조건</a></li>
  <li><a href="#두-독립-모집단의-분산-차이에-대한-등분산성-검정" id="toc-두-독립-모집단의-분산-차이에-대한-등분산성-검정" class="nav-link" data-scroll-target="#두-독립-모집단의-분산-차이에-대한-등분산성-검정">두 독립 모집단의 분산 차이에 대한 등분산성 검정</a></li>
  <li><a href="#cars93-데이터셋으로-실습하기" id="toc-cars93-데이터셋으로-실습하기" class="nav-link" data-scroll-target="#cars93-데이터셋으로-실습하기">Cars93 데이터셋으로 실습하기</a></li>
  </ul></li>
  <li><a href="#두-독립-모집단의-정규성을-보장하지-못할-때-평균-차이에-대한-비모수적-검정" id="toc-두-독립-모집단의-정규성을-보장하지-못할-때-평균-차이에-대한-비모수적-검정" class="nav-link" data-scroll-target="#두-독립-모집단의-정규성을-보장하지-못할-때-평균-차이에-대한-비모수적-검정">두 독립 모집단의 정규성을 보장하지 못할 때, 평균 차이에 대한 비모수적 검정</a>
  <ul class="collapse">
  <li><a href="#윌콕슨-순위합-검정이란" id="toc-윌콕슨-순위합-검정이란" class="nav-link" data-scroll-target="#윌콕슨-순위합-검정이란">윌콕슨 순위합 검정이란</a></li>
  <li><a href="#예제로-실습하기" id="toc-예제로-실습하기" class="nav-link" data-scroll-target="#예제로-실습하기">예제로 실습하기</a></li>
  <li><a href="#cars93-데이터셋으로-실습하기-1" id="toc-cars93-데이터셋으로-실습하기-1" class="nav-link" data-scroll-target="#cars93-데이터셋으로-실습하기-1">Cars93 데이터셋으로 실습하기</a></li>
  </ul></li>
  <li><a href="#대응표본-평균-차이-검정" id="toc-대응표본-평균-차이-검정" class="nav-link" data-scroll-target="#대응표본-평균-차이-검정">대응표본 평균 차이 검정</a>
  <ul class="collapse">
  <li><a href="#주변-이산화탄소-농도에-따른-나무의-이산화탄소-흡수율-차이-검정" id="toc-주변-이산화탄소-농도에-따른-나무의-이산화탄소-흡수율-차이-검정" class="nav-link" data-scroll-target="#주변-이산화탄소-농도에-따른-나무의-이산화탄소-흡수율-차이-검정">주변 이산화탄소 농도에 따른 나무의 이산화탄소 흡수율 차이 검정</a></li>
  <li><a href="#중간고사와-기말고사의-평균-비교5명이니-소표본임" id="toc-중간고사와-기말고사의-평균-비교5명이니-소표본임" class="nav-link" data-scroll-target="#중간고사와-기말고사의-평균-비교5명이니-소표본임">중간고사와 기말고사의 평균 비교(5명이니 소표본임)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="엑셀-실습하기" class="level1">
<h1>[엑셀] 실습하기</h1>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/11c2vcLd-oHIOs_xLF-8BTxlgd5Lp9Qk9Uo94zmuhw7U/edit?usp=sharing">하나의 모집단에 대한 가설검정(평균)</a> <small>(sasa메일로 로그인해야 내용을 볼 수 있습니다.)</small></li>
</ul>
</section>
<section id="r기초-실습하기" class="level1">
<h1>[R기초] 실습하기</h1>
<section id="모평균-mu에-대한-검정" class="level2">
<h2 class="anchored" data-anchor-id="모평균-mu에-대한-검정">모평균 <span class="math inline">\(\mu\)</span>에 대한 검정</h2>
<section id="sigma를-아는-경우" class="level3">
<h3 class="anchored" data-anchor-id="sigma를-아는-경우"><span class="math inline">\(\sigma\)</span>를 아는 경우</h3>
<ul>
<li>어떤 이들은 한국 청소년들의 하루 평균 TV 시청 시간이 3시간이라 주장하고, 다른 이들은 공부하느라 시청 시간이 3시간이 안될 것이라 주장하고 있다. 어느 편이 맞는지 알아보기 위하여 단순임의 추출한 100명을 조사한 결과 평균이 2.75시간이었다. TV 시청 시간은 정규분포를 하며 분산은 과거 조사에서 1로 알려져 있다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 가설검정을 위한 변수 설정(양측검정)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># 귀무 가설의 평균</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fl">2.75</span> <span class="co"># 표본의 평균</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># 모집단의 분산 (표준편차)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># 표본의 크기</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (xbar <span class="sc">-</span> mu0) <span class="sc">/</span> (sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))  <span class="co"># z-검정 수행</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(z))  <span class="co"># p-값 계산</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p_value  <span class="co"># 결과 출력</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01241933</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p값이 σ=0.05보다 작으므로 귀무가설을 기각하게 되어 </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 청소년들의 하루 평균 TV 시청 시간이 3시간이라고 할 수 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sigma를-모르는-경우" class="level3">
<h3 class="anchored" data-anchor-id="sigma를-모르는-경우"><span class="math inline">\(\sigma\)</span>를 모르는 경우</h3>
<ul>
<li>건강한 성인의 콜레스테롤 수치는 220 이하라고 한다. 콜레스테롤이 높은 사람은 심장마비가 발생할 가능성이 더 높은 것으로 알려져 있다. 이를 확인하기 위해 30명의 심장마비 환자를 조사하여 평균 콜레스테롤이 231이며, 표준편차가 20인 것을 알아냈다. 심장마비 환자들의 평균 콜레스테롤은 정상인의 평균 콜레스테롤보다 높은 수치라고 결론내릴 수 있는가?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>t_test <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, mu0, xbar, s, n){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">=</span> s<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">=</span> (xbar<span class="sc">-</span>mu0)<span class="sc">/</span>se</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    cr <span class="ot">=</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">=</span> <span class="fu">pt</span>(t, <span class="at">df=</span> n<span class="dv">-1</span>, <span class="at">lower.tail=</span>F)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(p_value <span class="sc">&lt;</span> alpha) result <span class="ot">=</span> <span class="st">"Reject H0"</span> <span class="cf">else</span> result <span class="ot">=</span> <span class="st">"Accept H0"</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Hypothesis testing for H0: mu = "</span>,mu0,<span class="st">"or Ha: mu &gt; "</span>,mu0))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"t Statistics is "</span>, <span class="fu">round</span>(t,<span class="dv">4</span>), </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"and Critical Region is "</span>, <span class="fu">round</span>(cr, <span class="dv">4</span>)), <span class="fu">paste</span>(<span class="st">"p-value ="</span>, <span class="fu">round</span>(p_value,<span class="dv">4</span>))))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(result, <span class="st">"at significance level"</span>, alpha))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">t_test</span>(<span class="fl">0.05</span>, <span class="dv">220</span>, <span class="dv">231</span>, <span class="dv">20</span>, <span class="dv">30</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hypothesis testing for H0: mu =  220 or Ha: mu &gt;  220"
[1] "t Statistics is  3.0125 and Critical Region is  1.6991"
[2] "p-value = 0.0027"                                      
[1] "Reject H0 at significance level 0.05"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p값이 σ=0.05보다 작으므로 귀무가설을 기각하게 되어 </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 심장마비 환자들의 평균 콜레스테롤은 정상의 평균 콜레스테롤보다 높다고 결론을 내린다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mass-라이브러리에-있는-cars93의-연료탱크용량의-모평균-추정하기t검정" class="level3">
<h3 class="anchored" data-anchor-id="mass-라이브러리에-있는-cars93의-연료탱크용량의-모평균-추정하기t검정">MASS 라이브러리에 있는 Cars93의 연료탱크용량의 모평균 추정하기(t검정)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fuel <span class="ot">=</span> Cars93<span class="sc">$</span>Fuel.tank.capacity</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">## mu of fuel is 16.</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: mu = 16</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># H1: mu is not 16 (양측검정)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="do">## normality test</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fuel)  <span class="co"># 좌우대칭인지 대략적으로 살펴보기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fuel)  <span class="co"># alpha=0.05 &gt; p ==&gt; H0 reject인데, p=0.287이므로 정규분포를 따름</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  fuel
W = 0.98341, p-value = 0.287</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. hypothesis H0 : mu=16  H1 : mu is not 16</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. alpha = 0/05</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. test statistic = barX ~ N()</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 4. p</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 5. alpha &gt; p ==&gt; H0 reject</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fuel, <span class="at">mu=</span><span class="dv">16</span>, <span class="at">alternative =</span> <span class="st">'two.sided'</span>)  <span class="co"># p=0.5372 &gt; 0.5이므로 H0를 기각할 수 없고, 즉 연료탱크 용량의 평균은 16이라 할 수 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  fuel
t = 1.9541, df = 92, p-value = 0.05372
alternative hypothesis: true mean is not equal to 16
95 percent confidence interval:
 15.98914 17.33989
sample estimates:
mean of x 
 16.66452 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fuel, <span class="at">mu=</span><span class="dv">16</span>, <span class="at">alternative =</span> <span class="st">'greater'</span>)  <span class="co"># p=0.02686 &lt; 0.5이므로 H0를 기각하고, 즉 연료탱크 용량의 평균은 16보다 큼(단측검정이 양측검정보다 귀무가설을 기각하기 쉬움)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  fuel
t = 1.9541, df = 92, p-value = 0.02686
alternative hypothesis: true mean is greater than 16
95 percent confidence interval:
 16.09949      Inf
sample estimates:
mean of x 
 16.66452 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fuel, <span class="at">mu=</span><span class="dv">16</span>, <span class="at">alternative =</span> <span class="st">'less'</span>)  <span class="co"># p=0.9731 &gt; 0.5이므로 H0를 채택한다. 즉 연료탱크 용량의 평균은 16보다 작지 않음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  fuel
t = 1.9541, df = 92, p-value = 0.9731
alternative hypothesis: true mean is less than 16
95 percent confidence interval:
     -Inf 17.22955
sample estimates:
mean of x 
 16.66452 </code></pre>
</div>
</div>
</section>
<section id="mass-라이브러리에-있는-cars93의-가격의-모평균-추정하기비모수적-방법" class="level3">
<h3 class="anchored" data-anchor-id="mass-라이브러리에-있는-cars93의-가격의-모평균-추정하기비모수적-방법">MASS 라이브러리에 있는 Cars93의 가격의 모평균 추정하기(비모수적 방법)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>price <span class="ot">=</span> Cars93<span class="sc">$</span>Price</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="do">## mu of fuel is 16.</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: mu = 16</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># H1: mu is not 16 (양측검정)</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="do">## normality test</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(price)  <span class="co"># 좌우대칭인지 대략적으로 살펴보기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(price)  <span class="co"># alpha &gt; p ==&gt; H0 reject인데, p=0.0000004235이므로 정규분포를 따른다고 할 수 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  price
W = 0.88051, p-value = 4.235e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Cars93$Price, nor normal dist~, n&gt;30이면 중심극한정리에 의해 표본평균의 정규성을 활용하여 검정</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">## n&lt;30(소표본) ==&gt; non-parametric test of one sample(비모수적 방법)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. hypothesis H0 : mu=19  H1 : mu is not 19</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. alpha = 0/05</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price, <span class="at">mu=</span><span class="dv">19</span>, <span class="at">alternative =</span> <span class="st">'two.sided'</span>) <span class="co"># 윌콕슨의 부호순위검정, alpha=0.05 &gt; p ==&gt; H0 reject인데, p=0.4701이므로 price의 평균은 19라 할 수 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  price
V = 1953, p-value = 0.4701
alternative hypothesis: true location is not equal to 19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price, <span class="at">mu=</span><span class="dv">19</span>, <span class="at">alternative =</span> <span class="st">'greater'</span>) <span class="co"># p=0.7662이므로 price의 평균은 19보다 크지 않음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  price
V = 1953, p-value = 0.7662
alternative hypothesis: true location is greater than 19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price, <span class="at">mu=</span><span class="dv">19</span>, <span class="at">alternative =</span> <span class="st">'less'</span>) <span class="co"># p=0.235이므로 price의 평균은 19보다 작지 않음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  price
V = 1953, p-value = 0.235
alternative hypothesis: true location is less than 19</code></pre>
</div>
</div>
</section>
</section>
<section id="모비율-p에-대한-검정" class="level2">
<h2 class="anchored" data-anchor-id="모비율-p에-대한-검정">모비율 <span class="math inline">\(p\)</span>에 대한 검정</h2>
<ul>
<li>경기도 어떤 지역에 새로운 지역 신문을 발행하기 위해서는 구독률이 12%를 넘어야 광고주를 안정적으로 확보할 수 있다고 한다. 새로운 지역 신문의 발행을 고심하는 한 신문사에서는 400명의 주민을 대상으로 만약 신문이 발행되면 구독을 할 것인지를 물어서 58명이 구독할 것이라는 답을 얻었다. 새로운 지역 신문의 구독률이 12%를 초과할 것이라고 결론내릴 수 있는가?(유의수준 5% 사용)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>prop_test <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, p, N, n){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    phat <span class="ot">=</span> n<span class="sc">/</span>N</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">=</span> <span class="fu">sqrt</span>((p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))<span class="sc">/</span>N)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">=</span> (phat <span class="sc">-</span> p) <span class="sc">/</span> se</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    cr <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">=</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail=</span>F)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(p_value <span class="sc">&lt;</span> alpha) result <span class="ot">=</span> <span class="st">"Reject H0"</span> <span class="cf">else</span> result <span class="ot">=</span> <span class="st">"Accept H0"</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Hypothesis testing for H0: mu = "</span>,p,<span class="st">"or Ha: mu &gt; "</span>,p))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"p_hat is "</span>, <span class="fu">round</span>(phat,<span class="dv">5</span>), <span class="st">"/ Z Statistics is "</span>, <span class="fu">round</span>(z,<span class="dv">4</span>),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"and Critical Region is "</span>, <span class="fu">round</span>(cr, <span class="dv">4</span>)), <span class="fu">paste</span>(<span class="st">"p-value ="</span>, <span class="fu">round</span>(p_value,<span class="dv">4</span>))))</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(result, <span class="st">"at significance level"</span>, alpha))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">prop_test</span>(<span class="fl">0.05</span>, <span class="fl">0.12</span>, <span class="dv">400</span>,<span class="dv">58</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hypothesis testing for H0: mu =  0.12 or Ha: mu &gt;  0.12"
[1] "p_hat is  0.145 / Z Statistics is  1.5386 and Critical Region is  1.6449"
[2] "p-value = 0.0619"                                                        
[1] "Accept H0 at significance level 0.05"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p값이 유의수준 σ=0.05를 초과하므로 귀무가설을 기각하지 못한다.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 새로운 지역 신문은 구독률이 12%를 초과할 것이라 결론내릴 수 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="두-독립-표본-위치-차이-검정" class="level2">
<h2 class="anchored" data-anchor-id="두-독립-표본-위치-차이-검정">두 독립 표본 위치 차이 검정</h2>
<section id="두-독립-표본-위치-차이-검정이란" class="level3">
<h3 class="anchored" data-anchor-id="두-독립-표본-위치-차이-검정이란">두 독립 표본 위치 차이 검정이란</h3>
<p>통계적 가설검정에서 두 독립 모집단에 대한 평균을 비교하는 검증으로,</p>
<ul>
<li>남녀 간의 성의식 차이</li>
<li>농촌과 도시 간의 주거만족도</li>
<li>수도권과 비수도권의 삶의 만족도</li>
</ul>
<p>와 같은 것들을, 보통 <span class="math inline">\(t\)</span>검정을 통해 두 독립 표본 평균의 차이를 비교한다.</p>
</section>
<section id="두-독립-모집단의-평균을-비교할-때의-조건" class="level3">
<h3 class="anchored" data-anchor-id="두-독립-모집단의-평균을-비교할-때의-조건">두 독립 모집단의 평균을 비교할 때의 조건</h3>
<ul>
<li>두 독립 모집단의 분포는 각각 정규분포여야 함</li>
<li>두 독립 모집단이 모두 정규분포이고, 분산이 알려져 있을때 <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(Z\)</span>검정을 통해 평균차이를 검정</li>
</ul>
<p><img src="ztest.png" class="center-image img-fluid"></p>
<ul>
<li>두 독립 모집단이 모두 정규분포이고, 분산이 알려져 있지 않을때 <span class="math inline">\(\rightarrow\)</span> 등분산인지 아닌지 검정 후, <span class="math inline">\(t\)</span>검정을 통해 평균차이를 검정 <img src="ttest1.png" class="center-image img-fluid"> <img src="ttest2.png" class="center-image img-fluid"></li>
</ul>
<p><img src="ttest3.png" class="center-image img-fluid"></p>
</section>
<section id="두-독립-모집단의-분산-차이에-대한-등분산성-검정" class="level3">
<h3 class="anchored" data-anchor-id="두-독립-모집단의-분산-차이에-대한-등분산성-검정">두 독립 모집단의 분산 차이에 대한 등분산성 검정</h3>
<ul>
<li>분산이 동일한지 동일하지 않은지에 따라 분산추정량이 달라지기에, 두 집단의 평균을 비교하기 전에 분산의 동일 여부를 검증하며, 이것을 <strong>등분산성 검증</strong>이라 한다.</li>
</ul>
<p><img src="vtest1.png" class="center-image img-fluid"></p>
<p><img src="vtest2.png" class="center-image img-fluid"></p>
</section>
<section id="cars93-데이터셋으로-실습하기" class="level3">
<h3 class="anchored" data-anchor-id="cars93-데이터셋으로-실습하기">Cars93 데이터셋으로 실습하기</h3>
<ul>
<li><span style="color: blue;"><strong>‘Cars93’ 데이터셋에서 미국회사 유무(Origin)에 따른 자동차의 가격(Price)에 대한 독립표본 <span class="math inline">\(t\)</span>검정하기</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two sample t-test</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Cars93<span class="sc">$</span>Origin)  <span class="co"># 데이터가 30개가 넘으므로 중심극한정리에 의해 정규성을 만족한다고 가정</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    USA non-USA 
     48      45 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># equal variance test: leven test,  alpha = 0.05 &gt; p ==&gt; H0 reject</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("lawstat")  # lawstat 패키지가 없으면 주석을 지우고 설치하기</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lawstat)  <span class="co"># levene.test()를 하기 위해 패키지 불러오기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lawstat' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levene.test</span>(Cars93<span class="sc">$</span>Price, Cars93<span class="sc">$</span>Origin, <span class="at">location =</span> <span class="st">'mean'</span>)  <span class="co"># H1 채택, 즉 두 집단의 분산이 다름</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Classical Levene's test based on the absolute deviations from the mean
    ( none not applied because the location is not set to median )

data:  Cars93$Price
Test Statistic = 4.2341, p-value = 0.04248</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two sample t-test</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>price0 <span class="ot">=</span> Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>Origin <span class="sc">==</span> <span class="st">'USA'</span>]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>price1 <span class="ot">=</span> Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>Origin <span class="sc">!=</span> <span class="st">'USA'</span>] <span class="co"># Cars93$Origin을 치면, non-USA값이지만 왼쪽과 같이 써도 됨</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(price0, price1, <span class="at">alternative =</span> <span class="st">'two.sided'</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)  <span class="co"># p=0.3428이므로 귀무가설 채택</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  price0 and price1
t = -0.95449, df = 77.667, p-value = 0.3428
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5.974255  2.102311
sample estimates:
mean of x mean of y 
 18.57292  20.50889 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(price0, price1, <span class="at">alternative =</span> <span class="st">'less'</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)  <span class="co"># p=0.1714이므로 귀무가설 채택</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  price0 and price1
t = -0.95449, df = 77.667, p-value = 0.1714
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
     -Inf 1.440539
sample estimates:
mean of x mean of y 
 18.57292  20.50889 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(price0, price1, <span class="at">alternative =</span> <span class="st">'greater'</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)  <span class="co"># p=0.8286이므로 귀무가설 채택</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  price0 and price1
t = -0.95449, df = 77.667, p-value = 0.8286
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 -5.312484       Inf
sample estimates:
mean of x mean of y 
 18.57292  20.50889 </code></pre>
</div>
</div>
<ul>
<li><span style="color: blue;"><strong>‘Cars93’ 데이터셋에서 수동변속기의 여부에 따른 자동차의 가격(Price)에 대한 독립표본 <span class="math inline">\(t\)</span>검정하기</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Cars93<span class="sc">$</span>Man.trans.avail) <span class="co"># 데이터가 30개가 넘으므로 중심극한정리에 의해 정규성을 만족한다고 가정</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 No Yes 
 32  61 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># equal variance test</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>price_0 <span class="ot">=</span> Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>Man.trans.avail <span class="sc">==</span> <span class="st">'Yes'</span>]</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>price_1 <span class="ot">=</span> Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>Man.trans.avail <span class="sc">!=</span> <span class="st">'Yes'</span>]</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levene.test</span>(Cars93<span class="sc">$</span>Price, Cars93<span class="sc">$</span>Man.trans.avail, <span class="at">location =</span> <span class="st">'mean'</span>)  <span class="co"># p=0.4405이므로 H0 채택, 즉 두 집단은 등분산임</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Classical Levene's test based on the absolute deviations from the mean
    ( none not applied because the location is not set to median )

data:  Cars93$Price
Test Statistic = 0.60016, p-value = 0.4405</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(price_0, price_1, <span class="at">alternative =</span> <span class="st">'two.sided'</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)  <span class="co"># p=0.001403이므로 H1 채택, 즉 수동변속기 유무에 따른 두 집단의 가격이 다르다 할 수 있음 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  price_0 and price_1
t = -3.2952, df = 91, p-value = 0.001403
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -10.583164  -2.622676
sample estimates:
mean of x mean of y 
 17.23770  23.84062 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(price_0, price_1, <span class="at">alternative =</span> <span class="st">'less'</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)  <span class="co"># p=0.0007013으로 양측검정때보다 더 작아짐</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  price_0 and price_1
t = -3.2952, df = 91, p-value = 0.0007013
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
      -Inf -3.273112
sample estimates:
mean of x mean of y 
 17.23770  23.84062 </code></pre>
</div>
</div>
</section>
</section>
<section id="두-독립-모집단의-정규성을-보장하지-못할-때-평균-차이에-대한-비모수적-검정" class="level2">
<h2 class="anchored" data-anchor-id="두-독립-모집단의-정규성을-보장하지-못할-때-평균-차이에-대한-비모수적-검정">두 독립 모집단의 정규성을 보장하지 못할 때, 평균 차이에 대한 비모수적 검정</h2>
<section id="윌콕슨-순위합-검정이란" class="level3">
<h3 class="anchored" data-anchor-id="윌콕슨-순위합-검정이란">윌콕슨 순위합 검정이란</h3>
<p><img src="wtest1.png" class="center-image img-fluid"></p>
<p><img src="wtest2.png" class="center-image img-fluid"></p>
</section>
<section id="예제로-실습하기" class="level3">
<h3 class="anchored" data-anchor-id="예제로-실습하기">예제로 실습하기</h3>
<ul>
<li><span style="color: blue;"><strong>남학생과 여학생의 중간시험 성적이 각각 다음과 같을때, 두 집단의 중간시험 성적의 평균이 같은지를 검정하고자 한다. 남학생: 74, 43, 91, 58, 60, 여학생: 50, 23, 69, 45 </strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 13 wilcoxon rank sum test for two sample </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>male <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">74</span>, <span class="dv">43</span>, <span class="dv">91</span>, <span class="dv">58</span>, <span class="dv">60</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>female <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">23</span>, <span class="dv">69</span>, <span class="dv">45</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(male) <span class="co"># normality test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  male
W = 0.97284, p-value = 0.8932</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(female) <span class="co"># 정규분포를 따른다고 p값이 나오지만 표본수가 적어서 정규분포를 따른다는 가정을 못하고, 윌콕슨 검정하기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  female
W = 0.98134, p-value = 0.9098</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">c</span>(male, female) <span class="co"># 데이터 합치기</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>rank_data <span class="ot">=</span> <span class="fu">rank</span>(data) <span class="co"># 데이터의 순위를 매기기</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>rank_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8 2 9 5 6 4 1 7 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>female_seq <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">length</span>(male)<span class="sc">+</span><span class="dv">1</span>, <span class="fu">length</span>(data)) <span class="co"># 여성 자료의 위치</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>female_seq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 7 8 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>female_rank <span class="ot">=</span> rank_data[female_seq]</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>female_rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 1 7 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>W <span class="ot">=</span> <span class="fu">sum</span>(female_rank)  <span class="co"># 더 적은 집단의 합을 W로 함</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>W  <span class="co"># 수작업으로 W구하기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(male, female, <span class="at">alternative =</span> <span class="st">'two.sided'</span>) <span class="co"># 바로 W를 구하고, p값 구함, (alpha = 0.05 &gt; p ==&gt; H0 reject) H0를 채택함, 즉 여학생과 남학생의 성적 평균의 차이가 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  male and female
W = 15, p-value = 0.2857
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="cars93-데이터셋으로-실습하기-1" class="level3">
<h3 class="anchored" data-anchor-id="cars93-데이터셋으로-실습하기-1">Cars93 데이터셋으로 실습하기</h3>
<ul>
<li><span style="color: blue;"><strong>‘Cars93’ 데이터셋에서 미국회사 유무에 따른 자동차의 가격(Price)에 대한 독립표본 윌콕슨 순위합 검정</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Cars93<span class="sc">$</span>Origin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    USA non-USA 
     48      45 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wilcoxon rank sum test , alpha = 0.05 &gt; p ==&gt; Ho rejcet</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>price_0 <span class="ot">=</span> Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>Origin <span class="sc">==</span> <span class="st">'USA'</span>]</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>price_1 <span class="ot">=</span> Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>Origin <span class="sc">!=</span> <span class="st">'USA'</span>]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price_0, price_1, <span class="at">alternative =</span> <span class="st">'two.sided'</span>) <span class="co"># p값 ==&gt; H0 채택, 즉 가격 차이가 없음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(price_0, price_1, alternative = "two.sided"):
cannot compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  price_0 and price_1
W = 1024.5, p-value = 0.6724
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price_0, price_1, <span class="at">alternative =</span> <span class="st">'less'</span>) <span class="co"># p값 ==&gt; H0 채택</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(price_0, price_1, alternative = "less"): cannot
compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  price_0 and price_1
W = 1024.5, p-value = 0.3362
alternative hypothesis: true location shift is less than 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price_0, price_1, <span class="at">alternative =</span> <span class="st">'greater'</span>) <span class="co"># p값 ==&gt; H0 채택</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(price_0, price_1, alternative = "greater"):
cannot compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  price_0 and price_1
W = 1024.5, p-value = 0.6666
alternative hypothesis: true location shift is greater than 0</code></pre>
</div>
</div>
<ul>
<li><span style="color: blue;"><strong>‘Cars93’ 데이터셋에서 수동변속기 유무에 따른 자동차의 가격(Price)에 대한 독립표본 윌콕슨 순위합 검정</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>price0 <span class="ot">=</span> Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>Man.trans.avail <span class="sc">==</span> <span class="st">'Yes'</span>]</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>price1 <span class="ot">=</span> Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>Man.trans.avail <span class="sc">!=</span> <span class="st">'Yes'</span>]</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price0, price1, <span class="at">alternative =</span> <span class="st">'two.sided'</span>) <span class="co"># p값 ==&gt; H0 기각, 즉 가격 차이가 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  price0 and price1
W = 530.5, p-value = 0.0003196
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price0, price1, <span class="at">alternative =</span> <span class="st">'less'</span>) <span class="co"># p값 ==&gt; H0 기각</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  price0 and price1
W = 530.5, p-value = 0.0001598
alternative hypothesis: true location shift is less than 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(price0, price1, <span class="at">alternative =</span> <span class="st">'greater'</span>) <span class="co"># 'less'가 가장 적당하다는 것을 알 수 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  price0 and price1
W = 530.5, p-value = 0.9998
alternative hypothesis: true location shift is greater than 0</code></pre>
</div>
</div>
</section>
</section>
<section id="대응표본-평균-차이-검정" class="level2">
<h2 class="anchored" data-anchor-id="대응표본-평균-차이-검정">대응표본 평균 차이 검정</h2>
<p>하나의 자료에 두 개의 대응되는 변수가 있을때, 두 변수의 평균의 차이가 있는지 검정하는 것</p>
<section id="주변-이산화탄소-농도에-따른-나무의-이산화탄소-흡수율-차이-검정" class="level3">
<h3 class="anchored" data-anchor-id="주변-이산화탄소-농도에-따른-나무의-이산화탄소-흡수율-차이-검정">주변 이산화탄소 농도에 따른 나무의 이산화탄소 흡수율 차이 검정</h3>
<p>데이터의 모양은 다음과 같다. <img src="co2data.png" class="center-image img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## paired t-test</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="do">## uptake of CO2</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(CO2)  <span class="co"># 데이터 구조 확인</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'nfnGroupedData', 'nfGroupedData', 'groupedData' and 'data.frame':  84 obs. of  5 variables:
 $ Plant    : Ord.factor w/ 12 levels "Qn1"&lt;"Qn2"&lt;"Qn3"&lt;..: 1 1 1 1 1 1 1 2 2 2 ...
 $ Type     : Factor w/ 2 levels "Quebec","Mississippi": 1 1 1 1 1 1 1 1 1 1 ...
 $ Treatment: Factor w/ 2 levels "nonchilled","chilled": 1 1 1 1 1 1 1 1 1 1 ...
 $ conc     : num  95 175 250 350 500 675 1000 95 175 250 ...
 $ uptake   : num  16 30.4 34.8 37.2 35.3 39.2 39.7 13.6 27.3 37.1 ...
 - attr(*, "formula")=Class 'formula'  language uptake ~ conc | Plant
  .. ..- attr(*, ".Environment")=&lt;environment: R_EmptyEnv&gt; 
 - attr(*, "outer")=Class 'formula'  language ~Treatment * Type
  .. ..- attr(*, ".Environment")=&lt;environment: R_EmptyEnv&gt; 
 - attr(*, "labels")=List of 2
  ..$ x: chr "Ambient carbon dioxide concentration"
  ..$ y: chr "CO2 uptake rate"
 - attr(*, "units")=List of 2
  ..$ x: chr "(uL/L)"
  ..$ y: chr "(umol/m^2 s)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>uptake_95   <span class="ot">=</span> CO2[CO2<span class="sc">$</span>conc <span class="sc">==</span> <span class="dv">95</span>, ]<span class="sc">$</span>uptake  <span class="co"># 주변 이산화탄소의 농도가 95일때 흡수율</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>uptake_1000 <span class="ot">=</span> CO2[CO2<span class="sc">$</span>conc <span class="sc">==</span> <span class="dv">1000</span>, ]<span class="sc">$</span>uptake  <span class="co"># 주변 이산화탄소의 농도가 1000일때 흡수율</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>uptake_95</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 16.0 13.6 16.2 14.2  9.3 15.1 10.6 12.0 11.3 10.5  7.7 10.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>uptake_1000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 39.7 44.3 45.5 38.7 42.4 41.4 35.5 31.5 27.8 21.9 14.4 19.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">data.frame</span>(uptake_95, uptake_1000),  <span class="co"># 상자 그림을 그려서 데이터 분포 확인</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">'uptake'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paired t-test : HO : mu_d = 0, mu_d is no 0</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. compare two variance </span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(uptake_95, uptake_1000) <span class="co"># 한 모집단 내 두 변수의 등분산성 검정, H0: equal variance ==&gt; not equal variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  uptake_95 and uptake_1000
F = 0.069007, num df = 11, denom df = 11, p-value = 0.0001066
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.01986555 0.23970934
sample estimates:
ratio of variances 
        0.06900694 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. t-test, 두 대응표본의 이산화탄소 흡수율(uptake)에 대해 대응표본 t검정</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(uptake_95, uptake_1000, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="co"># paired 파라미터를 TRUE로 설정하면 대응표본 t검정 실시</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">'two.sided'</span>) <span class="do">## reject H0, H1 채택, 주변이산화탄소 농도에 따른 이산화탄소 흡수율에 차이가 있다 할 수 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  uptake_95 and uptake_1000
t = -8.5197, df = 11, p-value = 3.573e-06
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -26.83414 -15.81586
sample estimates:
mean difference 
        -21.325 </code></pre>
</div>
</div>
</section>
<section id="중간고사와-기말고사의-평균-비교5명이니-소표본임" class="level3">
<h3 class="anchored" data-anchor-id="중간고사와-기말고사의-평균-비교5명이니-소표본임">중간고사와 기말고사의 평균 비교(5명이니 소표본임)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 수치형 변수이고, 표본이 작을 때 두 변수의 평균을 비교하는 비모수적 방법: 윌콕슨 부호 순위 검정</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="do">## non-parametric paired test : wilcoxon signed rank test</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>midterm <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">70</span>, <span class="dv">62</span>, <span class="dv">92</span>, <span class="dv">87</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>final <span class="ot">=</span>   <span class="fu">c</span>(<span class="dv">82</span>, <span class="dv">72</span>, <span class="dv">60</span>, <span class="dv">91</span>, <span class="dv">75</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(midterm, final, <span class="at">alternative =</span> <span class="st">'two.sided'</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">paired =</span> <span class="cn">TRUE</span>)  <span class="co"># H0 채택, 즉 차이가 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(midterm, final, alternative = "two.sided", :
cannot compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  midterm and final
V = 9, p-value = 0.7835
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="do">## tie(동점)가 있는 경우 ==&gt; wilcoxon test ==&gt; wilcox.exact() function</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('exactRankTests')  # 라이브러리가 없으면 주석 지우고 설치하기</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exactRankTests)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'exactRankTests' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> Package 'exactRankTests' is no longer under development.
 Please consider using package 'coin' instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.exact</span>(midterm, final, <span class="at">alternative =</span> <span class="st">'two.sided'</span>,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">paired =</span> <span class="cn">TRUE</span>)  <span class="co"># H0 채택, 즉 차이가 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Wilcoxon signed rank test

data:  midterm and final
V = 9, p-value = 0.8125
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
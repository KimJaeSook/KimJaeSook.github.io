<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kim Jae Sook">
<meta name="dcterms.date" content="2024-02-04">

<title>확률과 통계(2024) - 13. 분산분석</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">확률과 통계(2024)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">소개</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../webr.html"> 
<span class="menu-text">Web-R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../link.html"> 
<span class="menu-text">Link</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">13. 분산분석</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">교재 9장</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kim Jae Sook </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 4, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#엑셀-실습하기" id="toc-엑셀-실습하기" class="nav-link active" data-scroll-target="#엑셀-실습하기">[엑셀] 실습하기</a></li>
  <li><a href="#r기초-실습하기" id="toc-r기초-실습하기" class="nav-link" data-scroll-target="#r기초-실습하기">[R기초] 실습하기</a>
  <ul class="collapse">
  <li><a href="#f-분포x-sim-fdf1-df2" id="toc-f-분포x-sim-fdf1-df2" class="nav-link" data-scroll-target="#f-분포x-sim-fdf1-df2">F 분포(<small><span class="math inline">\(X \sim F(df1, df2)\)</span></small>)</a></li>
  <li><a href="#모수적-일원배치-분산분석" id="toc-모수적-일원배치-분산분석" class="nav-link" data-scroll-target="#모수적-일원배치-분산분석">모수적 일원배치 분산분석</a>
  <ul class="collapse">
  <li><a href="#일원배치-분산분석one-way-analysis-of-varianceanova이란" id="toc-일원배치-분산분석one-way-analysis-of-varianceanova이란" class="nav-link" data-scroll-target="#일원배치-분산분석one-way-analysis-of-varianceanova이란">일원배치 분산분석(One-way analysis of variance(ANOVA))이란?</a></li>
  <li><a href="#cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석" id="toc-cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석" class="nav-link" data-scroll-target="#cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석">Cars93데이터셋에서 에어백 유무에 따른 가격에 대한 일원배치 분산분석</a></li>
  </ul></li>
  <li><a href="#비모수적-일원배치-분산분석" id="toc-비모수적-일원배치-분산분석" class="nav-link" data-scroll-target="#비모수적-일원배치-분산분석">비모수적 일원배치 분산분석</a>
  <ul class="collapse">
  <li><a href="#비모수적-일원배치-분산분석이란" id="toc-비모수적-일원배치-분산분석이란" class="nav-link" data-scroll-target="#비모수적-일원배치-분산분석이란">비모수적 일원배치 분산분석이란?</a></li>
  <li><a href="#cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석-1" id="toc-cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석-1" class="nav-link" data-scroll-target="#cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석-1">Cars93데이터셋에서 에어백 유무에 따른 가격에 대한 일원배치 분산분석</a></li>
  </ul></li>
  <li><a href="#간단하게-살펴보는-일원배치분산분석-예제" id="toc-간단하게-살펴보는-일원배치분산분석-예제" class="nav-link" data-scroll-target="#간단하게-살펴보는-일원배치분산분석-예제">간단하게 살펴보는 일원배치분산분석 예제</a>
  <ul class="collapse">
  <li><a href="#자동차-충돌실험-결과-여러-등급의-자동차에서-인형의-파손-정도" id="toc-자동차-충돌실험-결과-여러-등급의-자동차에서-인형의-파손-정도" class="nav-link" data-scroll-target="#자동차-충돌실험-결과-여러-등급의-자동차에서-인형의-파손-정도">자동차 충돌실험 결과 여러 등급의 자동차에서 인형의 파손 정도</a></li>
  </ul></li>
  <li><a href="#이원배치분산분석" id="toc-이원배치분산분석" class="nav-link" data-scroll-target="#이원배치분산분석">이원배치분산분석</a>
  <ul class="collapse">
  <li><a href="#이원배치분산분석two-way-analysis-of-varianceanova이란" id="toc-이원배치분산분석two-way-analysis-of-varianceanova이란" class="nav-link" data-scroll-target="#이원배치분산분석two-way-analysis-of-varianceanova이란">이원배치분산분석(Two-way analysis of variance(ANOVA))이란</a></li>
  <li><a href="#cars93데이터셋에서-에어백-유무와-미국회사-유무에-따른-가격에-대한-이원배치-분산분석" id="toc-cars93데이터셋에서-에어백-유무와-미국회사-유무에-따른-가격에-대한-이원배치-분산분석" class="nav-link" data-scroll-target="#cars93데이터셋에서-에어백-유무와-미국회사-유무에-따른-가격에-대한-이원배치-분산분석">Cars93데이터셋에서 에어백 유무와 미국회사 유무에 따른 가격에 대한 이원배치 분산분석</a></li>
  <li><a href="#비모수적-방법프리드만-검정-freidman-test" id="toc-비모수적-방법프리드만-검정-freidman-test" class="nav-link" data-scroll-target="#비모수적-방법프리드만-검정-freidman-test">비모수적 방법(프리드만 검정, freidman test)</a></li>
  </ul></li>
  <li><a href="#반복측정-분산분석" id="toc-반복측정-분산분석" class="nav-link" data-scroll-target="#반복측정-분산분석">반복측정 분산분석</a>
  <ul class="collapse">
  <li><a href="#반복측정-분산분석이란" id="toc-반복측정-분산분석이란" class="nav-link" data-scroll-target="#반복측정-분산분석이란">반복측정 분산분석이란</a></li>
  <li><a href="#실습예제" id="toc-실습예제" class="nav-link" data-scroll-target="#실습예제">실습예제</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><strong>분산분석(analysis of variance, ANOVA)</strong>은 분산을 분석하기 때문에 지어진 이름이지만 그 목적은 평균을 분석하는 것이다. 여러 집단의 평균이 같은지, 아니면 하나라도 평균이 다른 집단이 있는지 판단하려는 것이 목적이다.</p>
<section id="엑셀-실습하기" class="level1">
<h1>[엑셀] 실습하기</h1>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1LmfMUNb_S5eS02N0c6UKNDqL3lH950PqKw3cqmKogno/edit?usp=sharing">분산분석</a> <small>(sasa메일로 로그인해야 내용을 볼 수 있습니다.)</small></li>
</ul>
</section>
<section id="r기초-실습하기" class="level1">
<h1>[R기초] 실습하기</h1>
<section id="f-분포x-sim-fdf1-df2" class="level2">
<h2 class="anchored" data-anchor-id="f-분포x-sim-fdf1-df2">F 분포(<small><span class="math inline">\(X \sim F(df1, df2)\)</span></small>)</h2>
<ul>
<li><p><span class="math inline">\(V_1\)</span>, <span class="math inline">\(V_2\)</span>가 서로 독립이고, 자유도가 각각 <span class="math inline">\(d_1\)</span>과 <span class="math inline">\(d_2\)</span>인 카이제곱(<span class="math inline">\(\chi^2\)</span>) 분포를 따를 때, <span class="math inline">\(F= \dfrac{V_1 / d_1}{V_2 /d_2}\)</span>의 분포를 자유도가 <span class="math inline">\((d_1 , d_2 )\)</span>인 <span class="math inline">\(F\)</span>분포라 한다.</p></li>
<li><p>F분포는 분자의 자유도 <span class="math inline">\(d_1\)</span>과 분모의 자유도 <span class="math inline">\(d_2\)</span> 두 개의 자유도에 의해 분포가 유일하게 결정된다. 아래 그림과 같이 분자와 분모의 자유도가 모두 커지면 좌우대칭인 분포를 따르는 형태가 나온다.</p></li>
</ul>
<p><img src="f.png" class="center-image img-fluid"> <small></small></p><small>
<div style="text-align: center;">
<p>* 그림 출처: 통계교육원, R을 활용한 통계분석</p>
</div>
</small><p><small></small></p>
<ul>
<li><p><strong>R에서 제공되는 F분포와 관련된 함수</strong></p></li>
<li><p>df() : <span class="math inline">\(P(X=x)\)</span></p></li>
<li><p>pf() : <span class="math inline">\(P(X&lt;x)\)</span> 또는 <span class="math inline">\(P(X \leq x)\)</span></p></li>
<li><p>qf() : <span class="math inline">\(P(X&lt;x)=p\)</span>가 되는 <span class="math inline">\(x\)</span>값</p></li>
<li><p>rf() : 주어진 카이제곱에서 난수를 뽑는 방법</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chi_squares distribution</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">df</span>(<span class="dv">1</span>, <span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">2</span>) <span class="co"># 분자의 자유도가 5, 분모의 자유도가 2인 F분포에서 X=1에서의 확률</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3080008</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="dv">1</span>, <span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">2</span>, <span class="at">lower.tail =</span> T) <span class="co"># 분자의 자유도가 5, 분모의 자유도가 2인 F분포에서 X가 1보다 작을 확률</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4312012</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="dv">1</span>, <span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">2</span>, <span class="at">lower.tail =</span> F) <span class="co"># 분자의 자유도가 5, 분모의 자유도가 2인 F분포에서 X가 1보다 클 확률</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5687988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.05</span>, <span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">2</span>, <span class="at">lower.tail =</span> T) <span class="co"># 분자의 자유도가 5, 분모의 자유도가 2인 F분포에서 확률이 0.05일때의 x값</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1728269</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.95</span>, <span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">2</span>, <span class="at">lower.tail =</span> T) <span class="co"># 분자의 자유도가 5, 분모의 자유도가 2인 F분포에서 확률이 0.95일때의 x값</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.29641</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">=</span> <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">2</span>) <span class="co"># 자유도가 4인 카이제곱분포에서 1000개의 수를 임의로 뽑기</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">max</span>(sample))<span class="sc">+</span><span class="dv">1</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">15</span>)) <span class="co"># 히스토그램 그리기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="모수적-일원배치-분산분석" class="level2">
<h2 class="anchored" data-anchor-id="모수적-일원배치-분산분석">모수적 일원배치 분산분석</h2>
<section id="일원배치-분산분석one-way-analysis-of-varianceanova이란" class="level3">
<h3 class="anchored" data-anchor-id="일원배치-분산분석one-way-analysis-of-varianceanova이란">일원배치 분산분석(One-way analysis of variance(ANOVA))이란?</h3>
<ul>
<li><p>일반적으로 3개 이상의 모집단에서 모평균을 비교하는 문제에서 사용되며, 이때 사용되는 변수는 두 가지로 분류된다. 한 변수는 범주형 변수(3가지 이상의 범주값)이고, 평균을 비교하고자 하는 변수는 수치형 변수(평균 비교에 사용되는 변수)이다.</p></li>
<li><p>평균을 비교하기 전에 세 집단의 분포가 정규분포인지, 집단 간 분산이 동일한지에 따라 그 결과가 다르다. 따라서 정규성 검정과 등분산성 검정을 먼저 실시하고 그 결과에 따라 평균을 비교하는 방법으로 진행한다.</p></li>
<li><p>일원배치 분산분석은 평균에 차이가 있다, 없다만 판단 가능하며 어느 집단끼리 차이가 있는지에 대해서는 알 수 없다. 3개 이상의 평균 차이가 있다면 사후 분석이라는 다중비교를 할 수 있다.</p></li>
<li><p>여러가지 다중비교 방법 중 <strong>Tukey HSD</strong> 검정이 있다.</p></li>
<li><p>세 가지 이상 집단의 평균비교임에도 평균비교라고 하지 않고 분산분석이라고 하는 이유는 분산비를 이용하여 평균 차이를 검정하기 때문이다.</p></li>
<li><p>분산분석 실험의 목적은 독립변수가 종속변수에 어떤 영향을 미치는지 알아보는 것이다.</p></li>
</ul>
<p><img src="anova.png" class="center-image img-fluid"></p>
<p><img src="one-way anova.png" class="center-image img-fluid"></p>
</section>
<section id="cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석" class="level3">
<h3 class="anchored" data-anchor-id="cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석">Cars93데이터셋에서 에어백 유무에 따른 가격에 대한 일원배치 분산분석</h3>
<ul>
<li><span style="color: blue;">에어백 유무의 3가지 범주: 에어백 없음, 운전석 에어백, 운전석과 조수석 에어백</span></li>
</ul>
<p><img src="study1.png" class="center2-image img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one-way ANalysis Of VAriance (ANOVA)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>Cars93<span class="sc">$</span>AirBags  <span class="co"># group variable = independent variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] None               Driver &amp; Passenger Driver only        Driver &amp; Passenger
 [5] Driver only        Driver only        Driver only        Driver only       
 [9] Driver only        Driver only        Driver &amp; Passenger None              
[13] Driver only        Driver &amp; Passenger None               None              
[17] None               Driver only        Driver only        Driver &amp; Passenger
[21] Driver &amp; Passenger Driver only        None               Driver only       
[25] Driver only        Driver only        Driver only        Driver only       
[29] None               Driver &amp; Passenger None               None              
[33] None               Driver only        Driver only        Driver only       
[37] Driver only        Driver only        None               Driver only       
[41] Driver &amp; Passenger Driver only        Driver &amp; Passenger None              
[45] None               None               None               Driver only       
[49] Driver only        Driver &amp; Passenger Driver &amp; Passenger Driver &amp; Passenger
[53] None               None               Driver only        None              
[57] Driver only        Driver only        Driver &amp; Passenger Driver only       
[61] None               None               Driver only        Driver only       
[65] Driver only        None               Driver only        None              
[69] Driver only        None               Driver only        None              
[73] None               None               Driver &amp; Passenger None              
[77] Driver &amp; Passenger Driver only        Driver only        None              
[81] None               Driver only        None               Driver only       
[85] Driver only        Driver only        Driver only        None              
[89] None               None               None               Driver only       
[93] Driver &amp; Passenger
Levels: Driver &amp; Passenger Driver only None</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Cars93<span class="sc">$</span>Price    <span class="co"># dependent variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 15.9 33.9 29.1 37.7 30.0 15.7 20.8 23.7 26.3 34.7 40.1 13.4 11.4 15.1 15.9
[16] 16.3 16.6 18.8 38.0 18.4 15.8 29.5  9.2 11.3 13.3 19.0 15.6 25.8 12.2 19.3
[31]  7.4 10.1 11.3 15.9 14.0 19.9 20.2 20.9  8.4 12.5 19.8 12.1 17.5  8.0 10.0
[46] 10.0 13.9 47.9 28.0 35.2 34.3 36.1  8.3 11.6 16.5 19.1 32.5 31.9 61.9 14.1
[61] 14.9 10.3 26.1 11.8 15.7 19.1 21.5 13.5 16.3 19.5 20.7 14.4  9.0 11.1 17.7
[76] 18.5 24.4 28.7 11.1  8.4 10.9 19.5  8.6  9.8 18.4 18.2 22.7  9.1 19.7 20.0
[91] 23.3 22.7 26.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dist~ of Airbags</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Cars93<span class="sc">$</span>AirBags)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Driver &amp; Passenger        Driver only               None 
                16                 43                 34 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Price normality test for AirBags: 세 가지 모두 검정결과 정규분포 따르지 않으나 표본수가 많으므로 중심극한정리에 의해 정규성을 가정해도 됨.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>AirBags <span class="sc">==</span><span class="st">'None'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Cars93$Price[Cars93$AirBags == "None"]
W = 0.92329, p-value = 0.02004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>AirBags <span class="sc">==</span><span class="st">'Driver only'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Cars93$Price[Cars93$AirBags == "Driver only"]
W = 0.93184, p-value = 0.01345</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(Cars93<span class="sc">$</span>Price[Cars93<span class="sc">$</span>AirBags <span class="sc">==</span><span class="st">'Driver &amp; Passenger'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Cars93$Price[Cars93$AirBags == "Driver &amp; Passenger"]
W = 0.8631, p-value = 0.02136</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Price equal variance test for AirBags : levene.test(), Bartlett()</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lawstat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lawstat' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levene.test</span>(Cars93<span class="sc">$</span>Price, Cars93<span class="sc">$</span>AirBags) <span class="co">#검정결과 등분산 아님</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Modified robust Brown-Forsythe Levene-type test based on the absolute
    deviations from the median

data:  Cars93$Price
Test Statistic = 8.1213, p-value = 0.0005721</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Cars93<span class="sc">$</span>Price <span class="sc">~</span> Cars93<span class="sc">$</span>AirBags) <span class="co">#검정결과 등분산 아님</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  Cars93$Price by Cars93$AirBags
Bartlett's K-squared = 24.899, df = 2, p-value = 3.92e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normality, equal variance(평소 많이 가정하는 것)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">## one-way ANOVA(집단간 평균비교)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Price <span class="sc">~</span> AirBags, Cars93, base<span class="sc">::</span>mean) <span class="co">#에어백 여부에 따른 가격의 평균 계산</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             AirBags    Price
1 Driver &amp; Passenger 28.36875
2        Driver only 21.22326
3               None 13.17353</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## if equal variance : aov()   oneway.test()</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">aov</span>(Price <span class="sc">~</span> AirBags, <span class="at">data=</span>Cars93) <span class="co">#검정결과 각 집단간에 적어도 하나의 그룹은 평균이 다르다 할 수 있음</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)    
AirBags      2   2747  1373.5   21.18 2.9e-08 ***
Residuals   90   5837    64.9                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(Price <span class="sc">~</span> AirBags, <span class="at">data=</span>Cars93, <span class="at">var.equal =</span> T) <span class="co">#위와 같은 결과임</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means

data:  Price and AirBags
F = 21.178, num df = 2, denom df = 90, p-value = 2.901e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## if no equal vaiance : oneway.test()</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(Price <span class="sc">~</span> AirBags, <span class="at">data=</span>Cars93, <span class="at">var.equal =</span> F) <span class="co">#검정결과 각 집단간에 적어도 하나의 그룹은 평균이 다르다 할 수 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  Price and AirBags
F = 23.082, num df = 2.000, denom df = 34.479, p-value = 4.35e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## TukeyHSD() : post Hoc if reject HO of one-way ANOVA [사후검정]</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="do">## equal variance 가정 ==&gt; aov함수 사용하기</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">aov</span>(Price <span class="sc">~</span> AirBags, <span class="at">data=</span>Cars93)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(result) <span class="co">#검정결과 세 그룹 모두 가격 평균이 다르다 할 수 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Price ~ AirBags, data = Cars93)

$AirBags
                                     diff       lwr       upr     p adj
Driver only-Driver &amp; Passenger  -7.145494 -12.76566 -1.525327 0.0088790
None-Driver &amp; Passenger        -15.195221 -21.01361 -9.376828 0.0000000
None-Driver only                -8.049726 -12.45415 -3.645302 0.0001033</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(result, <span class="st">"AirBags"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="비모수적-일원배치-분산분석" class="level2">
<h2 class="anchored" data-anchor-id="비모수적-일원배치-분산분석">비모수적 일원배치 분산분석</h2>
<section id="비모수적-일원배치-분산분석이란" class="level3">
<h3 class="anchored" data-anchor-id="비모수적-일원배치-분산분석이란">비모수적 일원배치 분산분석이란?</h3>
<ul>
<li>비모수적 검정(크루스칼-왈리스 검정, Kruskal-Wallis test)은 세 집단 이상의 평균을 비교할 때, 각 집단에서 정규성 검정을 만족하지 못하거나 소표본인 경우 실행하며 순위평균의 차이 여부를 가지고 모집단의 평균 차이 여부를 알아본다.</li>
</ul>
<p><img src="Kruskal-Wallis test.png" class="center-image img-fluid"></p>
</section>
<section id="cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석-1" class="level3">
<h3 class="anchored" data-anchor-id="cars93데이터셋에서-에어백-유무에-따른-가격에-대한-일원배치-분산분석-1">Cars93데이터셋에서 에어백 유무에 따른 가격에 대한 일원배치 분산분석</h3>
<ul>
<li><span style="color: blue;">에어백 유무의 3가지 범주: 에어백 없음, 운전석 에어백, 운전석과 조수석 에어백</span></li>
</ul>
<p><img src="study2.png" class="center2-image img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Kruskal-wallis test : non-parametric test</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Cars93<span class="sc">$</span>AirBags)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Driver &amp; Passenger        Driver only               None 
                16                 43                 34 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Price<span class="sc">~</span>AirBags, Cars93, base<span class="sc">::</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             AirBags    Price
1 Driver &amp; Passenger 28.36875
2        Driver only 21.22326
3               None 13.17353</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normality test : alpha = 0.05 ==&gt; 0.01 ??(유의수준을 0.01로 변경하면 모든 그룹이 정규성을 따름)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(Cars93<span class="sc">$</span>Price, Cars93<span class="sc">$</span>AirBags, shapiro.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Driver &amp; Passenger`

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.8631, p-value = 0.02136


$`Driver only`

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.93184, p-value = 0.01345


$None

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.92329, p-value = 0.02004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if HO reject ==&gt; Kruskal-wallis test(정규성을 만족하지 않으면 비모수적 검정)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Kruskal Wallis test : HO: means for all groups equal</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(Price <span class="sc">~</span> AirBags, <span class="at">data=</span>Cars93) <span class="co"># 검정결과 적어도 하나의 그룹은 다른 그룹과 차이가 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Price by AirBags
Kruskal-Wallis chi-squared = 32.639, df = 2, p-value = 8.175e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## mutiple comparison or Post Hoc test [사후검정]</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="do">### parametric test : Tukey, Scheffe, Games-Howell, Tukey's Honest Significant Difference(HSD)</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="do">### non-parametric test : 1) density plot for grop   2) dunn.test   3) mctp()</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="do">### 1) density plot: moonBook package</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("moonBook") # moomBook패키지가 없으면 주석 지우고 설치하기</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moonBook)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'moonBook' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(Price<span class="sc">~</span>AirBags, <span class="at">data=</span>Cars93) <span class="co">#그래프를 보는 방법으로 주관적임</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ' Price ' is an invalid column name: Instead ' Min.Price ' is used</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 2) Ddunn's multiple comparison test: dunn.test package</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('dunn.test') # dunn.test패키지가 없으면 주석 지우고 설치하기</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dunn.test)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dunn.test</span>(Cars93<span class="sc">$</span>Price, Cars93<span class="sc">$</span>AirBags, <span class="at">method=</span><span class="st">'bonferroni'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Kruskal-Wallis rank sum test

data: x and group
Kruskal-Wallis chi-squared = 32.6393, df = 2, p-value = 0

                           Comparison of x by group                            
                                 (Bonferroni)                                  
Col Mean-|
Row Mean |   Driver &amp;   Driver o
---------+----------------------
Driver o |   1.717373
         |     0.1289
         |
    None |   5.078861   4.517930
         |    0.0000*    0.0000*

alpha = 0.05
Reject Ho if p &lt;= alpha/2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 3) mctp(): nparcomp package, 정규분포이고 등분산 아닐때 사용</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('nparcomp') # nparcomp패키지가 없으면 주석 지우고 설치하기</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nparcomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'nparcomp' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: multcomp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'multcomp' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'mvtnorm' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TH.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'TH.data' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'TH.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">mctp</span>(Price <span class="sc">~</span> AirBags, <span class="at">data=</span>Cars93)  <span class="co"># tukey default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 #----------------Nonparametric Multiple Comparisons for relative effects---------------# 
 
 - Alternative Hypothesis:  True differences of relative effects are not equal to 0 
 - Estimation Method:  Global Pseudo Ranks 
 - Type of Contrast : Tukey 
 - Confidence Level: 95 % 
 - Method = Fisher with 28 DF 
 
 #--------------------------------------------------------------------------------------# 
 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 #----------------Nonparametric Multiple Comparisons for relative effects---------------# 
 
 - Alternative Hypothesis:  True differences of relative effects are not equal to 0 
 - Estimation Method: Global Pseudo ranks 
 - Type of Contrast : Tukey 
 - Confidence Level: 95 % 
 - Method = Fisher with 28 DF 
 
 #--------------------------------------------------------------------------------------# 
 
 #----Data Info-------------------------------------------------------------------------# 
              Sample Size    Effect     Lower     Upper
1 Driver &amp; Passenger   16 0.6950239 0.6310752 0.7522398
2        Driver only   43 0.5464974 0.4880819 0.6036599
3               None   34 0.2584787 0.2201847 0.3008632

 #----Contrast--------------------------------------------------------------------------# 
       1  2 3
2 - 1 -1  1 0
3 - 1 -1  0 1
3 - 2  0 -1 1

 #----Analysis--------------------------------------------------------------------------# 
      Estimator  Lower  Upper Statistic      p.Value
2 - 1    -0.149 -0.310  0.021    -2.153 9.323711e-02
3 - 1    -0.437 -0.555 -0.301    -7.298 4.413419e-07
3 - 2    -0.288 -0.402 -0.166    -5.632 1.376006e-05

 #----Overall---------------------------------------------------------------------------# 
  Quantile      p.Value
1 2.453078 4.413419e-07

 #--------------------------------------------------------------------------------------# </code></pre>
</div>
</div>
</section>
</section>
<section id="간단하게-살펴보는-일원배치분산분석-예제" class="level2">
<h2 class="anchored" data-anchor-id="간단하게-살펴보는-일원배치분산분석-예제">간단하게 살펴보는 일원배치분산분석 예제</h2>
<section id="자동차-충돌실험-결과-여러-등급의-자동차에서-인형의-파손-정도" class="level3">
<h3 class="anchored" data-anchor-id="자동차-충돌실험-결과-여러-등급의-자동차에서-인형의-파손-정도">자동차 충돌실험 결과 여러 등급의 자동차에서 인형의 파손 정도</h3>
<ul>
<li><span style="color: blue;">자동차 충돌실험의 결과 인형의 파손 정도가 다음과 같다. 이 데이터를 사용하여 인형의 파손 정도는 자동차의 크기에 관계없이 동일하다는 귀무가설을 검정하시오.</span></li>
</ul>
<div class="my-table2">
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>소형자동차</th>
<th>준중형자동차</th>
<th>중형자동차</th>
<th>대형자동차</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>681</td>
<td>643</td>
<td>469</td>
<td>384</td>
</tr>
<tr class="even">
<td></td>
<td>728</td>
<td>655</td>
<td>727</td>
<td>656</td>
</tr>
<tr class="odd">
<td></td>
<td>917</td>
<td>742</td>
<td>525</td>
<td>602</td>
</tr>
<tr class="even">
<td></td>
<td>898</td>
<td>514</td>
<td>454</td>
<td>687</td>
</tr>
<tr class="odd">
<td></td>
<td>620</td>
<td>525</td>
<td>459</td>
<td>360</td>
</tr>
<tr class="even">
<td>평균</td>
<td>768.8</td>
<td>615.8</td>
<td>526.8</td>
<td>537.8</td>
</tr>
<tr class="odd">
<td>표준편차</td>
<td>132.4</td>
<td>95.9</td>
<td>115.5</td>
<td>154.6</td>
</tr>
</tbody>
</table>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">681</span>, <span class="dv">728</span>, <span class="dv">917</span>, <span class="dv">898</span>, <span class="dv">620</span>,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>       <span class="dv">643</span>, <span class="dv">655</span>, <span class="dv">742</span>, <span class="dv">514</span>, <span class="dv">525</span>,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>       <span class="dv">469</span>, <span class="dv">727</span>, <span class="dv">525</span>, <span class="dv">454</span>, <span class="dv">459</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>       <span class="dv">384</span>, <span class="dv">656</span>, <span class="dv">602</span>, <span class="dv">687</span>, <span class="dv">360</span>) </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"소형"</span>,<span class="st">"준중형"</span>,<span class="st">"중형"</span>,<span class="st">"대형"</span>), <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span><span class="fu">factor</span>(x)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>aov.result<span class="ot">=</span><span class="fu">aov</span>(y <span class="sc">~</span> x)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov.result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
x            3 186825   62275   3.893  0.029 *
Residuals   16 255923   15995                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F통계량값인 3.8934가 기각역에 있으므로 귀무가설을 기각한다.</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 또는 p값 0.029가 유의수준 0.05보다 작으므로 귀무가설을 기각한다.</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 자동차의 크기에 따른 등급은 인형모형의 파손 정도에 통계적으로 유의한 차이를 보인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="이원배치분산분석" class="level2">
<h2 class="anchored" data-anchor-id="이원배치분산분석">이원배치분산분석</h2>
<section id="이원배치분산분석two-way-analysis-of-varianceanova이란" class="level3">
<h3 class="anchored" data-anchor-id="이원배치분산분석two-way-analysis-of-varianceanova이란">이원배치분산분석(Two-way analysis of variance(ANOVA))이란</h3>
<p><img src="two-way anova1.png" class="center2-image img-fluid"></p>
<p><img src="two-way anova2.png" class="center-image img-fluid"></p>
<p><img src="two-way anova3.png" class="center-image img-fluid"></p>
</section>
<section id="cars93데이터셋에서-에어백-유무와-미국회사-유무에-따른-가격에-대한-이원배치-분산분석" class="level3">
<h3 class="anchored" data-anchor-id="cars93데이터셋에서-에어백-유무와-미국회사-유무에-따른-가격에-대한-이원배치-분산분석">Cars93데이터셋에서 에어백 유무와 미국회사 유무에 따른 가격에 대한 이원배치 분산분석</h3>
<ul>
<li><span style="color: blue;">균형자료라고 가정하고 검정하기</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two-way ANOVA </span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)  <span class="co"># Cars93</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="do">## factor1 : AirBags</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="do">## factor2 : Origin </span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="do">## dependent variable : Price</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">replications</span>(Price <span class="sc">~</span> AirBags <span class="sc">*</span> Origin, Cars93) <span class="co">#균형설계자료인지 확인(각 범주별로 자료수가 동일한지)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$AirBags
AirBags
Driver &amp; Passenger        Driver only               None 
                16                 38                 28 

$Origin
Origin
    USA non-USA 
     42      40 

$`AirBags:Origin`
                    Origin
AirBags              USA non-USA
  Driver &amp; Passenger   9       7
  Driver only         20      18
  None                13      15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Price<span class="sc">~</span>AirBags, Cars93, base<span class="sc">::</span>mean) <span class="co">#평균 비교해보기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             AirBags    Price
1 Driver &amp; Passenger 28.36875
2        Driver only 21.22326
3               None 13.17353</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Price<span class="sc">~</span>Origin, Cars93, base<span class="sc">::</span>mean) <span class="co">#평균 비교해보기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Origin    Price
1     USA 18.57292
2 non-USA 20.50889</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## two-way  anova :  parametric method , balanced data(지금 자료가 불균형이지만 균형자료라고 가정하고 검정)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="do">### 1) for factor1 HO: All means are equal</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="do">### 2) for facotr2 HO: all means are equal</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="do">### 3) for interaction factor1*factor2 : HO: all means are equal</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="do">## method1(모수적 방법1)</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">aov</span>(Price <span class="sc">~</span> AirBags <span class="sc">*</span> Origin, <span class="at">data=</span> Cars93) <span class="co">#정규성,등분산성을 만족한다고 가정하고 분산분석 실시</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
AirBags         2   2747  1373.5  21.925 1.95e-08 ***
Origin          1    170   170.3   2.719    0.103    
AirBags:Origin  2    217   108.4   1.730    0.183    
Residuals      87   5450    62.6                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## method2 (모수적 방법2)</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(Price <span class="sc">~</span> AirBags <span class="sc">*</span> Origin, <span class="at">data=</span>Cars93))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Price
               Df Sum Sq Mean Sq F value    Pr(&gt;F)    
AirBags         2 2747.0 1373.49 21.9254 1.947e-08 ***
Origin          1  170.3  170.31  2.7186    0.1028    
AirBags:Origin  2  216.7  108.35  1.7296    0.1834    
Residuals      87 5450.0   62.64                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>위 검정 결과, 에어벡 여부에 따른 각 집단간의 평균은 적어도 하나는 다르고, 미국회사 유무에 따른 각 집단의 평균은 모두 같다. 또한 에어백 여부와 미국회사 유무의 상호작용에 따른 각 집단의 평균은 모두 같다.</p></li>
<li><p>위 자료가 불균형자료인데, 균형자료라고 가정하고 검정했다. 균형자료일 경우에는 아래 그림에서 aov, anova 함수의 기본옵션인 type2로 계산한다. 불균형자료는 type3로 계산해야 한다.</p></li>
</ul>
<p><img src="unbalanced.png" class="center-image img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">## two-way ANOVA for  unbalanced data  : Type3 SS</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Anova()  ==&gt; car package </span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('car')  # car 라이브러리가 없으면 주석 지우고 설치하기</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'car' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'carData' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lawstat':

    levene.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">aov</span>(Price <span class="sc">~</span> AirBags <span class="sc">*</span> Origin, <span class="at">data=</span> Cars93)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(result, <span class="at">type=</span><span class="dv">3</span>)  <span class="co"># 검정결과 미국회사유무에 따라서도 가격 차이가 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in printHypothesis(L, rhs, names(b)): one or more coefficients in the hypothesis include
     arithmetic operators in their names;
  the printed representation of the hypothesis will be omitted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in printHypothesis(L, rhs, names(b)): one or more coefficients in the hypothesis include
     arithmetic operators in their names;
  the printed representation of the hypothesis will be omitted</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Price
               Sum Sq Df F value    Pr(&gt;F)    
(Intercept)    5436.6  1 86.7857 1.013e-14 ***
AirBags         802.8  2  6.4076  0.002535 ** 
Origin          295.6  1  4.7194  0.032544 *  
AirBags:Origin  216.7  2  1.7296  0.183391    
Residuals      5450.0 87                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## plot for interaction effect(상호작용 효과가 있을때 그려보기)</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(Cars93<span class="sc">$</span>AirBags, Cars93<span class="sc">$</span>Origin, Cars93<span class="sc">$</span>Price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="비모수적-방법프리드만-검정-freidman-test" class="level3">
<h3 class="anchored" data-anchor-id="비모수적-방법프리드만-검정-freidman-test">비모수적 방법(프리드만 검정, freidman test)</h3>
<ul>
<li><span style="color: blue;">주조시간에 따라 강도에 차이가 있는지 검정하자.(소표본)</span></li>
</ul>
<p><img src="strength.png" class="center2-image img-fluid"></p>
<p><img src="strengthdata.png" class="center-image img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## non-parametric : two-way ANOVA  ==&gt; freidman test</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="do">## factor1: independent variable</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="do">## factor2: block(실험에서 차이가 있어도 되고 없어도 될때 block이라 함)</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="do">## dependent variable </span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"strength.csv"</span>, <span class="at">header =</span> T)  <span class="co"># 첫번째행에 변수명 있음</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)  <span class="co"># 자료 구조 살피기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   9 obs. of  3 variables:
 $ A      : chr  "A1" "A1" "A1" "A2" ...
 $ B      : chr  "B1" "B2" "B3" "B1" ...
 $ strenth: int  90 95 100 100 94 100 104 110 113</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman.test</span>(data<span class="sc">$</span>strenth, data<span class="sc">$</span>A, data<span class="sc">$</span>B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Friedman rank sum test

data:  data$strenth, data$A and data$B
Friedman chi-squared = 4.9091, df = 2, p-value = 0.0859</code></pre>
</div>
</div>
</section>
</section>
<section id="반복측정-분산분석" class="level2">
<h2 class="anchored" data-anchor-id="반복측정-분산분석">반복측정 분산분석</h2>
<section id="반복측정-분산분석이란" class="level3">
<h3 class="anchored" data-anchor-id="반복측정-분산분석이란">반복측정 분산분석이란</h3>
<p><img src="repeated1.png" class="center-image img-fluid"></p>
<p><img src="repeated2.png" class="center-image img-fluid"></p>
<p><img src="repeated3.png" class="center-image img-fluid"></p>
</section>
<section id="실습예제" class="level3">
<h3 class="anchored" data-anchor-id="실습예제">실습예제</h3>
<ul>
<li><span style="color: blue;">주변 이산화탄소의 여러 농도에 따른 나무의 이산화탄소 흡수율 비교</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">## repeated measure ANOVA</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. one - repeated factor, dependent variable(사전에 정규성, 등분산성 검증은 사전에 실시해야 함)</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 'CO2' </span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(CO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'nfnGroupedData', 'nfGroupedData', 'groupedData' and 'data.frame':  84 obs. of  5 variables:
 $ Plant    : Ord.factor w/ 12 levels "Qn1"&lt;"Qn2"&lt;"Qn3"&lt;..: 1 1 1 1 1 1 1 2 2 2 ...
 $ Type     : Factor w/ 2 levels "Quebec","Mississippi": 1 1 1 1 1 1 1 1 1 1 ...
 $ Treatment: Factor w/ 2 levels "nonchilled","chilled": 1 1 1 1 1 1 1 1 1 1 ...
 $ conc     : num  95 175 250 350 500 675 1000 95 175 250 ...
 $ uptake   : num  16 30.4 34.8 37.2 35.3 39.2 39.7 13.6 27.3 37.1 ...
 - attr(*, "formula")=Class 'formula'  language uptake ~ conc | Plant
  .. ..- attr(*, ".Environment")=&lt;environment: R_EmptyEnv&gt; 
 - attr(*, "outer")=Class 'formula'  language ~Treatment * Type
  .. ..- attr(*, ".Environment")=&lt;environment: R_EmptyEnv&gt; 
 - attr(*, "labels")=List of 2
  ..$ x: chr "Ambient carbon dioxide concentration"
  ..$ y: chr "CO2 uptake rate"
 - attr(*, "units")=List of 2
  ..$ x: chr "(uL/L)"
  ..$ y: chr "(umol/m^2 s)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dependent variable : uptake(이산화탄소 흡수율)</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># repeated factor : conc(이산화탄소 농도)</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Plant   Type  Treatment conc uptake
1   Qn1 Quebec nonchilled   95   16.0
2   Qn1 Quebec nonchilled  175   30.4
3   Qn1 Quebec nonchilled  250   34.8
4   Qn1 Quebec nonchilled  350   37.2
5   Qn1 Quebec nonchilled  500   35.3
6   Qn1 Quebec nonchilled  675   39.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="at">formula =</span> uptake<span class="sc">~</span>conc, <span class="at">data=</span>CO2) <span class="co"># 이산화탄소 농도에 따른 이산화탄소 흡수율의 상자그림</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">=</span> <span class="fu">aggregate</span>(uptake<span class="sc">~</span>conc, CO2, base<span class="sc">::</span>mean)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  conc   uptake
1   95 12.25833
2  175 22.28333
3  250 28.87500
4  350 30.66667
5  500 30.87500
6  675 31.95000
7 1000 33.58333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="do">## repeated ANOVA </span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="do">## H0: means of uptake for conc are same</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">aov</span>(uptake <span class="sc">~</span> conc <span class="sc">+</span> <span class="fu">Error</span>(Plant<span class="sc">/</span>conc), <span class="at">data=</span>CO2) <span class="co"># conc factor는 반복측정되므로 오차항에 Error(Plant/conc)로 넣어줘야 함</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result) <span class="co"># H0기각, 주변 이산화탄소 농도에 따른 이산화탄소 흡수율에는 차이가 있다고 할 수 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Error: Plant
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 11   4862     442               

Error: Plant:conc
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
conc       1 2285.0  2285.0   70.39 4.14e-06 ***
Residuals 11  357.1    32.5                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Error: Within
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 60   2203   36.71               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="do">## cf one-way ANOVA</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">=</span> <span class="fu">aov</span>(uptake <span class="sc">~</span> conc, <span class="at">data=</span>CO2)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result1) <span class="co"># 반복이 없는 분산분석의 MSE는 90.5, 반복측정분산분석의 MSE는 32.5로 반복측정 시, F값의 분모인 MSE가 더 작으므로 검정력이 높음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
conc         1   2285  2285.0   25.25 2.91e-06 ***
Residuals   82   7422    90.5                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Post-Hoc test</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(CO2, <span class="fu">pairwise.t.test</span>(uptake, conc, <span class="at">paired=</span>T, <span class="at">p.adjust.method=</span><span class="st">'bonferroni'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using paired t tests 

data:  uptake and conc 

     95      175     250     350     500     675    
175  0.00025 -       -       -       -       -      
250  0.00012 0.00736 -       -       -       -      
350  0.00013 0.00098 0.53879 -       -       -      
500  0.00012 0.00268 0.01458 1.00000 -       -      
675  4.5e-05 0.00052 0.00210 0.83520 0.76607 -      
1000 7.5e-05 0.00059 0.00253 0.01468 0.01741 0.10482

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<p><span style="color: blue;">- 저온처리 유무가 추가되었을때, 주변 이산화탄소의 여러 농도에 따른 나무의 이산화탄소 흡수율 비교</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="do">## one factor, one repeated factor ==&gt; two-way repeated ANOVA</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Treatment(저온처리 유무), conc(주변 이산화탄소 농도) </span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Plant   Type  Treatment conc uptake
1   Qn1 Quebec nonchilled   95   16.0
2   Qn1 Quebec nonchilled  175   30.4
3   Qn1 Quebec nonchilled  250   34.8
4   Qn1 Quebec nonchilled  350   37.2
5   Qn1 Quebec nonchilled  500   35.3
6   Qn1 Quebec nonchilled  675   39.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(uptake<span class="sc">~</span>conc, CO2, base<span class="sc">::</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  conc   uptake
1   95 12.25833
2  175 22.28333
3  250 28.87500
4  350 30.66667
5  500 30.87500
6  675 31.95000
7 1000 33.58333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(uptake<span class="sc">~</span>Treatment, CO2, base<span class="sc">::</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Treatment   uptake
1 nonchilled 30.64286
2    chilled 23.78333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>result3 <span class="ot">=</span> <span class="fu">aov</span>(uptake<span class="sc">~</span>Treatment<span class="sc">*</span>conc <span class="sc">+</span> <span class="fu">Error</span>(Plant<span class="sc">/</span>conc), <span class="at">data=</span>CO2)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Error: Plant
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Treatment  1    988   988.1   2.551  0.141
Residuals 10   3874   387.4               

Error: Plant:conc
               Df Sum Sq Mean Sq F value  Pr(&gt;F)    
conc            1 2285.0  2285.0   70.27 7.8e-06 ***
Treatment:conc  1   31.9    31.9    0.98   0.346    
Residuals      10  325.2    32.5                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Error: Within
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 60   2203   36.71               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## cf  two-way ANOVA</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>result4 <span class="ot">=</span> <span class="fu">aov</span>(uptake<span class="sc">~</span>Treatment<span class="sc">*</span>conc, <span class="at">data=</span>CO2)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Treatment       1    988   988.1  12.348  0.00073 ***
conc            1   2285  2285.0  28.554 8.38e-07 ***
Treatment:conc  1     32    31.9   0.398  0.52979    
Residuals      80   6402    80.0                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>